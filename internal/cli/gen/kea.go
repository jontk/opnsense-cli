// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/kea"
	"github.com/spf13/cobra"
)

func init() {
	registerKea()
}

func registerKea() {
	moduleCmd := &cobra.Command{
		Use:   "kea",
		Short: "Manage kea resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			if len(args) == 0 {
				return cmd.Help()
			}
			msg := fmt.Sprintf("unknown command %q for %q", args[0], cmd.CommandPath())
			if sugg := cmd.SuggestionsFor(args[0]); len(sugg) > 0 {
				msg += "\n\nDid you mean this?"
				for _, s := range sugg {
					msg += "\n\t" + s
				}
			}
			return fmt.Errorf("%s\n\nRun '%s --help' for usage.", msg, cmd.CommandPath())
		},
	}
	moduleCmd.AddCommand(newKeaCtrlAgentCmd())
	moduleCmd.AddCommand(newKeaPeerCmd())
	moduleCmd.AddCommand(newKeaReservationCmd())
	moduleCmd.AddCommand(newKeaSubnetCmd())
	moduleCmd.AddCommand(newKeaDhcpv4Cmd())
	moduleCmd.AddCommand(newKeaPdPoolCmd())
	moduleCmd.AddCommand(newKeaDhcpv6Cmd())
	moduleCmd.AddCommand(newKeaServiceCmd())
	cli.Root.AddCommand(moduleCmd)
}

func newKeaCtrlAgentCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "ctrl-agent",
		Short: "Manage kea ctrl-agent resources",
	}
	cmd.AddCommand(newKeaCtrlAgentGetCmd())
	cmd.AddCommand(newKeaCtrlAgentSetCmd())
	return cmd
}

func newKeaCtrlAgentGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get kea ctrl-agent",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.CtrlAgentGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaCtrlAgentSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set kea ctrl-agent",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.CtrlAgentSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// keaPeerColumns defines table columns for the Peer resource.
var keaPeerColumns = []cli.Column{
	{Header: "NAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Peer); ok {
			return fmt.Sprint(v.Name)
		}
		return ""
	}},
	{Header: "ROLE", Extract: func(row any) string {
		if v, ok := row.(sdk.Peer); ok {
			return fmt.Sprint(v.Role)
		}
		return ""
	}},
	{Header: "URL", Extract: func(row any) string {
		if v, ok := row.(sdk.Peer); ok {
			return fmt.Sprint(v.Url)
		}
		return ""
	}},
}

func newKeaPeerCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "peer",
		Short: "Manage kea peer resources",
	}
	cmd.AddCommand(newKeaPeerCreateCmd())
	cmd.AddCommand(newKeaPeerDeleteCmd())
	cmd.AddCommand(newKeaPeerGetCmd())
	cmd.AddCommand(newKeaPeerListCmd())
	cmd.AddCommand(newKeaPeerUpdateCmd())
	return cmd
}

func newKeaPeerCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create kea peer",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Peer
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4AddPeer(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newKeaPeerDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete kea peer",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4DelPeer(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newKeaPeerGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get kea peer",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4GetPeer(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newKeaPeerListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List kea peer resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.Dhcpv4SearchPeer(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, keaPeerColumns)
		},
	}
}

func newKeaPeerUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update kea peer",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Peer
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4SetPeer(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

// keaReservationColumns defines table columns for the Reservation resource.
var keaReservationColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Reservation); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "SUBNET", Extract: func(row any) string {
		if v, ok := row.(sdk.Reservation); ok {
			return fmt.Sprint(v.Subnet)
		}
		return ""
	}},
	{Header: "IP ADDRESS", Extract: func(row any) string {
		if v, ok := row.(sdk.Reservation); ok {
			return fmt.Sprint(v.IpAddress)
		}
		return ""
	}},
	{Header: "HW ADDRESS", Extract: func(row any) string {
		if v, ok := row.(sdk.Reservation); ok {
			return fmt.Sprint(v.HwAddress)
		}
		return ""
	}},
	{Header: "HOSTNAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Reservation); ok {
			return fmt.Sprint(v.Hostname)
		}
		return ""
	}},
}

func newKeaReservationCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "reservation",
		Short: "Manage kea reservation resources",
	}
	cmd.AddCommand(newKeaReservationCreateCmd())
	cmd.AddCommand(newKeaReservationDeleteCmd())
	cmd.AddCommand(newKeaReservationGetCmd())
	cmd.AddCommand(newKeaReservationListCmd())
	cmd.AddCommand(newKeaReservationUpdateCmd())
	return cmd
}

func newKeaReservationCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create kea reservation",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Reservation
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4AddReservation(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newKeaReservationDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete kea reservation",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4DelReservation(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newKeaReservationGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get kea reservation",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4GetReservation(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newKeaReservationListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List kea reservation resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.Dhcpv4SearchReservation(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, keaReservationColumns)
		},
	}
}

func newKeaReservationUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update kea reservation",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Reservation
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4SetReservation(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

// keaSubnetColumns defines table columns for the Subnet resource.
var keaSubnetColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Subnet4); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "SUBNET", Extract: func(row any) string {
		if v, ok := row.(sdk.Subnet4); ok {
			return fmt.Sprint(v.Subnet)
		}
		return ""
	}},
	{Header: "NEXT SERVER", Extract: func(row any) string {
		if v, ok := row.(sdk.Subnet4); ok {
			return fmt.Sprint(v.NextServer)
		}
		return ""
	}},
	{Header: "OPTION DATA AUTOCOLLECT", Extract: func(row any) string {
		if v, ok := row.(sdk.Subnet4); ok {
			return fmt.Sprint(v.OptionDataAutocollect)
		}
		return ""
	}},
	{Header: "MATCH-CLIENT-ID", Extract: func(row any) string {
		if v, ok := row.(sdk.Subnet4); ok {
			return fmt.Sprint(v.MatchClientId)
		}
		return ""
	}},
	{Header: "POOLS", Extract: func(row any) string {
		if v, ok := row.(sdk.Subnet4); ok {
			return fmt.Sprint(v.Pools)
		}
		return ""
	}},
}

func newKeaSubnetCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "subnet",
		Short: "Manage kea subnet resources",
	}
	cmd.AddCommand(newKeaSubnetCreateCmd())
	cmd.AddCommand(newKeaSubnetDeleteCmd())
	cmd.AddCommand(newKeaSubnetGetCmd())
	cmd.AddCommand(newKeaSubnetListCmd())
	cmd.AddCommand(newKeaSubnetUpdateCmd())
	return cmd
}

func newKeaSubnetCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create kea subnet",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Subnet4
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4AddSubnet(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newKeaSubnetDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete kea subnet",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4DelSubnet(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newKeaSubnetGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get kea subnet",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4GetSubnet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newKeaSubnetListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List kea subnet resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.Dhcpv4SearchSubnet(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, keaSubnetColumns)
		},
	}
}

func newKeaSubnetUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update kea subnet",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Subnet4
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4SetSubnet(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newKeaDhcpv4Cmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "dhcpv4",
		Short: "Manage kea dhcpv4 resources",
	}
	cmd.AddCommand(newKeaDhcpv4DownloadReservationsCmd())
	cmd.AddCommand(newKeaDhcpv4GetCmd())
	cmd.AddCommand(newKeaDhcpv4SetCmd())
	cmd.AddCommand(newKeaDhcpv4UploadReservationsCmd())
	return cmd
}

func newKeaDhcpv4DownloadReservationsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "download-reservations",
		Short: "DownloadReservations kea dhcpv4",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4DownloadReservations(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaDhcpv4GetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get kea dhcpv4",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4Get(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaDhcpv4SetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set kea dhcpv4",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4Set(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaDhcpv4UploadReservationsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "upload-reservations",
		Short: "UploadReservations kea dhcpv4",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv4UploadReservations(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// keaPdPoolColumns defines table columns for the PdPool resource.
var keaPdPoolColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.PdPool); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "SUBNET", Extract: func(row any) string {
		if v, ok := row.(sdk.PdPool); ok {
			return fmt.Sprint(v.Subnet)
		}
		return ""
	}},
	{Header: "PREFIX", Extract: func(row any) string {
		if v, ok := row.(sdk.PdPool); ok {
			return fmt.Sprint(v.Prefix)
		}
		return ""
	}},
	{Header: "PREFIX LEN", Extract: func(row any) string {
		if v, ok := row.(sdk.PdPool); ok {
			return fmt.Sprint(v.PrefixLen)
		}
		return ""
	}},
	{Header: "DELEGATED LEN", Extract: func(row any) string {
		if v, ok := row.(sdk.PdPool); ok {
			return fmt.Sprint(v.DelegatedLen)
		}
		return ""
	}},
}

func newKeaPdPoolCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "pd-pool",
		Short: "Manage kea pd-pool resources",
	}
	cmd.AddCommand(newKeaPdPoolCreateCmd())
	cmd.AddCommand(newKeaPdPoolDeleteCmd())
	cmd.AddCommand(newKeaPdPoolGetCmd())
	cmd.AddCommand(newKeaPdPoolListCmd())
	cmd.AddCommand(newKeaPdPoolUpdateCmd())
	return cmd
}

func newKeaPdPoolCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create kea pd-pool",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.PdPool
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv6AddPdPool(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newKeaPdPoolDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete kea pd-pool",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv6DelPdPool(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newKeaPdPoolGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get kea pd-pool",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv6GetPdPool(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newKeaPdPoolListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List kea pd-pool resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.Dhcpv6SearchPdPool(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, keaPdPoolColumns)
		},
	}
}

func newKeaPdPoolUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update kea pd-pool",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.PdPool
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv6SetPdPool(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newKeaDhcpv6Cmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "dhcpv6",
		Short: "Manage kea dhcpv6 resources",
	}
	cmd.AddCommand(newKeaDhcpv6DownloadReservationsCmd())
	cmd.AddCommand(newKeaDhcpv6GetCmd())
	cmd.AddCommand(newKeaDhcpv6SetCmd())
	cmd.AddCommand(newKeaDhcpv6UploadReservationsCmd())
	return cmd
}

func newKeaDhcpv6DownloadReservationsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "download-reservations",
		Short: "DownloadReservations kea dhcpv6",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv6DownloadReservations(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaDhcpv6GetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get kea dhcpv6",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv6Get(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaDhcpv6SetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set kea dhcpv6",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv6Set(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaDhcpv6UploadReservationsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "upload-reservations",
		Short: "UploadReservations kea dhcpv6",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.Dhcpv6UploadReservations(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage kea service resources",
	}
	cmd.AddCommand(newKeaServiceReconfigureCmd())
	cmd.AddCommand(newKeaServiceRestartCmd())
	cmd.AddCommand(newKeaServiceStartCmd())
	cmd.AddCommand(newKeaServiceStatusCmd())
	cmd.AddCommand(newKeaServiceStopCmd())
	return cmd
}

func newKeaServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure kea service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart kea service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start kea service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaServiceStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status kea service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newKeaServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop kea service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

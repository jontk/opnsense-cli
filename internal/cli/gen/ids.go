// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/ids"
	"github.com/spf13/cobra"
)

func init() {
	registerIds()
}

func registerIds() {
	moduleCmd := &cobra.Command{
		Use:   "ids",
		Short: "Manage ids resources",
	}
	moduleCmd.AddCommand(newIdsServiceCmd())
	moduleCmd.AddCommand(newIdsAlertInfoCmd())
	moduleCmd.AddCommand(newIdsAlertLogsCmd())
	moduleCmd.AddCommand(newIdsPolicyCmd())
	moduleCmd.AddCommand(newIdsPolicyRuleCmd())
	moduleCmd.AddCommand(newIdsUserRuleCmd())
	moduleCmd.AddCommand(newIdsSettingsCmd())
	moduleCmd.AddCommand(newIdsRuleInfoCmd())
	moduleCmd.AddCommand(newIdsRulesetCmd())
	moduleCmd.AddCommand(newIdsRulesetpropertiesCmd())
	moduleCmd.AddCommand(newIdsInstalledRulesCmd())
	moduleCmd.AddCommand(newIdsRuleCmd())
	cli.Root.AddCommand(moduleCmd)
}

func newIdsServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage ids service resources",
	}
	cmd.AddCommand(newIdsServiceDropAlertLogCmd())
	cmd.AddCommand(newIdsServiceQueryAlertsCmd())
	cmd.AddCommand(newIdsServiceReconfigureCmd())
	cmd.AddCommand(newIdsServiceReloadRulesCmd())
	cmd.AddCommand(newIdsServiceRestartCmd())
	cmd.AddCommand(newIdsServiceStartCmd())
	cmd.AddCommand(newIdsServiceStatusCmd())
	cmd.AddCommand(newIdsServiceStopCmd())
	cmd.AddCommand(newIdsServiceUpdateRulesCmd())
	return cmd
}

func newIdsServiceDropAlertLogCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "drop-alert-log",
		Short: "DropAlertLog ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceDropAlertLog(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsServiceQueryAlertsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "query-alerts",
		Short: "QueryAlerts ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceQueryAlerts(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsServiceReloadRulesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reload-rules",
		Short: "ReloadRules ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReloadRules(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsServiceStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsServiceUpdateRulesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "update-rules",
		Short: "UpdateRules ids service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceUpdateRules(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsAlertInfoCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "alert-info",
		Short: "Manage ids alert-info resources",
	}
	cmd.AddCommand(newIdsAlertInfoGetAlertInfoCmd())
	return cmd
}

func newIdsAlertInfoGetAlertInfoCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-alert-info <alertId>",
		Short: "GetAlertInfo ids alert-info",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceGetAlertInfo(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsAlertLogsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "alert-logs",
		Short: "Manage ids alert-logs resources",
	}
	cmd.AddCommand(newIdsAlertLogsGetAlertLogsCmd())
	return cmd
}

func newIdsAlertLogsGetAlertLogsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-alert-logs",
		Short: "GetAlertLogs ids alert-logs",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceGetAlertLogs(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// idsPolicyColumns defines table columns for the Policy resource.
var idsPolicyColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Policy); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Policy); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "CONTENT", Extract: func(row any) string {
		if v, ok := row.(sdk.Policy); ok {
			return fmt.Sprint(v.Content)
		}
		return ""
	}},
	{Header: "PRIO", Extract: func(row any) string {
		if v, ok := row.(sdk.Policy); ok {
			return fmt.Sprint(v.Prio)
		}
		return ""
	}},
	{Header: "ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Policy); ok {
			return fmt.Sprint(v.Action)
		}
		return ""
	}},
	{Header: "RULESETS", Extract: func(row any) string {
		if v, ok := row.(sdk.Policy); ok {
			return fmt.Sprint(v.Rulesets)
		}
		return ""
	}},
	{Header: "NEW ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Policy); ok {
			return fmt.Sprint(v.NewAction)
		}
		return ""
	}},
}

func newIdsPolicyCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "policy",
		Short: "Manage ids policy resources",
	}
	cmd.AddCommand(newIdsPolicyCreateCmd())
	cmd.AddCommand(newIdsPolicyDeleteCmd())
	cmd.AddCommand(newIdsPolicyGetCmd())
	cmd.AddCommand(newIdsPolicyListCmd())
	cmd.AddCommand(newIdsPolicyUpdateCmd())
	cmd.AddCommand(newIdsPolicyToggleCmd())
	return cmd
}

func newIdsPolicyCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ids policy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Policy
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddPolicy(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIdsPolicyDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ids policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelPolicy(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIdsPolicyGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ids policy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetPolicy(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIdsPolicyListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ids policy resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchPolicy(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, idsPolicyColumns)
		},
	}
}

func newIdsPolicyUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update ids policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Policy
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetPolicy(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIdsPolicyToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ids policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsTogglePolicy(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// idsPolicyRuleColumns defines table columns for the PolicyRule resource.
var idsPolicyRuleColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "SID", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Sid)
		}
		return ""
	}},
	{Header: "ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Action)
		}
		return ""
	}},
	{Header: "MSG", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Msg)
		}
		return ""
	}},
	{Header: "SOURCE", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Source)
		}
		return ""
	}},
}

func newIdsPolicyRuleCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "policy-rule",
		Short: "Manage ids policy-rule resources",
	}
	cmd.AddCommand(newIdsPolicyRuleCreateCmd())
	cmd.AddCommand(newIdsPolicyRuleDeleteCmd())
	cmd.AddCommand(newIdsPolicyRuleGetCmd())
	cmd.AddCommand(newIdsPolicyRuleListCmd())
	cmd.AddCommand(newIdsPolicyRuleUpdateCmd())
	cmd.AddCommand(newIdsPolicyRuleToggleCmd())
	return cmd
}

func newIdsPolicyRuleCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ids policy-rule",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Rule
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddPolicyRule(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIdsPolicyRuleDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ids policy-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelPolicyRule(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIdsPolicyRuleGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ids policy-rule",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetPolicyRule(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIdsPolicyRuleListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ids policy-rule resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchPolicyRule(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, idsPolicyRuleColumns)
		},
	}
}

func newIdsPolicyRuleUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update ids policy-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Rule
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetPolicyRule(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIdsPolicyRuleToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ids policy-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsTogglePolicyRule(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// idsUserRuleColumns defines table columns for the UserRule resource.
var idsUserRuleColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "SID", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Sid)
		}
		return ""
	}},
	{Header: "ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Action)
		}
		return ""
	}},
	{Header: "MSG", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Msg)
		}
		return ""
	}},
	{Header: "SOURCE", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Source)
		}
		return ""
	}},
}

func newIdsUserRuleCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "user-rule",
		Short: "Manage ids user-rule resources",
	}
	cmd.AddCommand(newIdsUserRuleCreateCmd())
	cmd.AddCommand(newIdsUserRuleDeleteCmd())
	cmd.AddCommand(newIdsUserRuleGetCmd())
	cmd.AddCommand(newIdsUserRuleListCmd())
	cmd.AddCommand(newIdsUserRuleUpdateCmd())
	cmd.AddCommand(newIdsUserRuleToggleCmd())
	return cmd
}

func newIdsUserRuleCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ids user-rule",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Rule
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddUserRule(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIdsUserRuleDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ids user-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelUserRule(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIdsUserRuleGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ids user-rule",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetUserRule(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIdsUserRuleListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ids user-rule resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchUserRule(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, idsUserRuleColumns)
		},
	}
}

func newIdsUserRuleUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update ids user-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Rule
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetUserRule(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIdsUserRuleToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ids user-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleUserRule(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIdsSettingsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "settings",
		Short: "Manage ids settings resources",
	}
	cmd.AddCommand(newIdsSettingsCheckPolicyRuleCmd())
	cmd.AddCommand(newIdsSettingsGetCmd())
	cmd.AddCommand(newIdsSettingsListRuleMetadataCmd())
	cmd.AddCommand(newIdsSettingsListRulesetsCmd())
	cmd.AddCommand(newIdsSettingsSetCmd())
	return cmd
}

func newIdsSettingsCheckPolicyRuleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "check-policy-rule",
		Short: "CheckPolicyRule ids settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsCheckPolicyRule(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsSettingsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ids settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsSettingsListRuleMetadataCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list-rule-metadata",
		Short: "ListRuleMetadata ids settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsListRuleMetadata(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsSettingsListRulesetsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list-rulesets",
		Short: "ListRulesets ids settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsListRulesets(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsSettingsSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set ids settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// idsRuleInfoColumns defines table columns for the RuleInfo resource.
var idsRuleInfoColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "SID", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Sid)
		}
		return ""
	}},
	{Header: "ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Action)
		}
		return ""
	}},
	{Header: "MSG", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Msg)
		}
		return ""
	}},
	{Header: "SOURCE", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Source)
		}
		return ""
	}},
}

func newIdsRuleInfoCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "rule-info",
		Short: "Manage ids rule-info resources",
	}
	cmd.AddCommand(newIdsRuleInfoGetCmd())
	return cmd
}

func newIdsRuleInfoGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ids rule-info",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetRuleInfo(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIdsRulesetCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "ruleset",
		Short: "Manage ids ruleset resources",
	}
	cmd.AddCommand(newIdsRulesetGetRulesetCmd())
	cmd.AddCommand(newIdsRulesetSetRulesetCmd())
	cmd.AddCommand(newIdsRulesetToggleRulesetCmd())
	return cmd
}

func newIdsRulesetGetRulesetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-ruleset <id>",
		Short: "GetRuleset ids ruleset",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetRuleset(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsRulesetSetRulesetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set-ruleset <filename>",
		Short: "SetRuleset ids ruleset",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetRuleset(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsRulesetToggleRulesetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle-ruleset <filenames>",
		Short: "ToggleRuleset ids ruleset",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleRuleset(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsRulesetpropertiesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "rulesetproperties",
		Short: "Manage ids rulesetproperties resources",
	}
	cmd.AddCommand(newIdsRulesetpropertiesGetRulesetpropertiesCmd())
	cmd.AddCommand(newIdsRulesetpropertiesSetRulesetpropertiesCmd())
	return cmd
}

func newIdsRulesetpropertiesGetRulesetpropertiesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-rulesetproperties",
		Short: "GetRulesetproperties ids rulesetproperties",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetRulesetproperties(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsRulesetpropertiesSetRulesetpropertiesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set-rulesetproperties",
		Short: "SetRulesetproperties ids rulesetproperties",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetRulesetproperties(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIdsInstalledRulesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "installed-rules",
		Short: "Manage ids installed-rules resources",
	}
	cmd.AddCommand(newIdsInstalledRulesSearchInstalledRulesCmd())
	return cmd
}

func newIdsInstalledRulesSearchInstalledRulesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search-installed-rules",
		Short: "SearchInstalledRules ids installed-rules",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSearchInstalledRules(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// idsRuleColumns defines table columns for the Rule resource.
var idsRuleColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "SID", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Sid)
		}
		return ""
	}},
	{Header: "ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Action)
		}
		return ""
	}},
	{Header: "MSG", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Msg)
		}
		return ""
	}},
	{Header: "SOURCE", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Source)
		}
		return ""
	}},
}

func newIdsRuleCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "rule",
		Short: "Manage ids rule resources",
	}
	cmd.AddCommand(newIdsRuleUpdateCmd())
	cmd.AddCommand(newIdsRuleToggleCmd())
	return cmd
}

func newIdsRuleUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <sid>",
		Short: "Update ids rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Rule
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetRule(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIdsRuleToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <sids>",
		Short: "Toggle ids rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleRule(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/ipsec"
	"github.com/spf13/cobra"
)

func init() {
	registerIpsec()
}

func registerIpsec() {
	moduleCmd := &cobra.Command{
		Use:   "ipsec",
		Short: "Manage ipsec resources",
	}
	moduleCmd.AddCommand(newIpsecChildCmd())
	moduleCmd.AddCommand(newIpsecConnectionCmd())
	moduleCmd.AddCommand(newIpsecLocalCmd())
	moduleCmd.AddCommand(newIpsecRemoteCmd())
	moduleCmd.AddCommand(newIpsecKeyPairsCmd())
	moduleCmd.AddCommand(newIpsecLeasesCmd())
	moduleCmd.AddCommand(newIpsecLegacySubsystemCmd())
	moduleCmd.AddCommand(newIpsecManualSpdCmd())
	moduleCmd.AddCommand(newIpsecPoolsCmd())
	moduleCmd.AddCommand(newIpsecPreSharedKeysCmd())
	moduleCmd.AddCommand(newIpsecSadCmd())
	moduleCmd.AddCommand(newIpsecServiceCmd())
	moduleCmd.AddCommand(newIpsecSessionsCmd())
	moduleCmd.AddCommand(newIpsecPhase1Cmd())
	moduleCmd.AddCommand(newIpsecPhase2Cmd())
	moduleCmd.AddCommand(newIpsecSettingsCmd())
	moduleCmd.AddCommand(newIpsecSpdCmd())
	moduleCmd.AddCommand(newIpsecTunnelCmd())
	moduleCmd.AddCommand(newIpsecVtiCmd())
	cli.Root.AddCommand(moduleCmd)
}

// ipsecChildColumns defines table columns for the Child resource.
var ipsecChildColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Child); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Child); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "CONNECTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Child); ok {
			return fmt.Sprint(v.Connection)
		}
		return ""
	}},
	{Header: "REQID", Extract: func(row any) string {
		if v, ok := row.(sdk.Child); ok {
			return fmt.Sprint(v.Reqid)
		}
		return ""
	}},
	{Header: "ESP PROPOSALS", Extract: func(row any) string {
		if v, ok := row.(sdk.Child); ok {
			return fmt.Sprint(v.EspProposals)
		}
		return ""
	}},
	{Header: "SHA256 96", Extract: func(row any) string {
		if v, ok := row.(sdk.Child); ok {
			return fmt.Sprint(v.Sha25696)
		}
		return ""
	}},
	{Header: "START ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Child); ok {
			return fmt.Sprint(v.StartAction)
		}
		return ""
	}},
	{Header: "CLOSE ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Child); ok {
			return fmt.Sprint(v.CloseAction)
		}
		return ""
	}},
}

func newIpsecChildCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "child",
		Short: "Manage ipsec child resources",
	}
	cmd.AddCommand(newIpsecChildCreateCmd())
	cmd.AddCommand(newIpsecChildDeleteCmd())
	cmd.AddCommand(newIpsecChildGetCmd())
	cmd.AddCommand(newIpsecChildListCmd())
	cmd.AddCommand(newIpsecChildUpdateCmd())
	cmd.AddCommand(newIpsecChildToggleCmd())
	return cmd
}

func newIpsecChildCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ipsec child",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Child
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsAddChild(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecChildDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ipsec child",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsDelChild(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecChildGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec child",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsGetChild(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecChildListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ipsec child resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ConnectionsSearchChild(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, ipsecChildColumns)
		},
	}
}

func newIpsecChildUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update",
		Short: "Update ipsec child",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Child
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsSetChild(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecChildToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ipsec child",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsToggleChild(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// ipsecConnectionColumns defines table columns for the Connection resource.
var ipsecConnectionColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Connection); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Connection); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "PROPOSALS", Extract: func(row any) string {
		if v, ok := row.(sdk.Connection); ok {
			return fmt.Sprint(v.Proposals)
		}
		return ""
	}},
	{Header: "UNIQUE", Extract: func(row any) string {
		if v, ok := row.(sdk.Connection); ok {
			return fmt.Sprint(v.Unique)
		}
		return ""
	}},
	{Header: "AGGRESSIVE", Extract: func(row any) string {
		if v, ok := row.(sdk.Connection); ok {
			return fmt.Sprint(v.Aggressive)
		}
		return ""
	}},
	{Header: "VERSION", Extract: func(row any) string {
		if v, ok := row.(sdk.Connection); ok {
			return fmt.Sprint(v.Version)
		}
		return ""
	}},
	{Header: "MOBIKE", Extract: func(row any) string {
		if v, ok := row.(sdk.Connection); ok {
			return fmt.Sprint(v.Mobike)
		}
		return ""
	}},
	{Header: "LOCAL ADDRS", Extract: func(row any) string {
		if v, ok := row.(sdk.Connection); ok {
			return fmt.Sprint(v.LocalAddrs)
		}
		return ""
	}},
}

func newIpsecConnectionCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "connection",
		Short: "Manage ipsec connection resources",
	}
	cmd.AddCommand(newIpsecConnectionCreateCmd())
	cmd.AddCommand(newIpsecConnectionDeleteCmd())
	cmd.AddCommand(newIpsecConnectionGetCmd())
	cmd.AddCommand(newIpsecConnectionListCmd())
	cmd.AddCommand(newIpsecConnectionUpdateCmd())
	cmd.AddCommand(newIpsecConnectionToggleCmd())
	cmd.AddCommand(newIpsecConnectionConnectionExistsCmd())
	cmd.AddCommand(newIpsecConnectionIsEnabledCmd())
	cmd.AddCommand(newIpsecConnectionSetCmd())
	cmd.AddCommand(newIpsecConnectionSwanctlCmd())
	return cmd
}

func newIpsecConnectionCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ipsec connection",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Connection
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsAddConnection(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecConnectionDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ipsec connection",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsDelConnection(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecConnectionGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec connection",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsGetConnection(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecConnectionListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ipsec connection resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ConnectionsSearchConnection(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, ipsecConnectionColumns)
		},
	}
}

func newIpsecConnectionUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update",
		Short: "Update ipsec connection",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Connection
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsSetConnection(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecConnectionToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ipsec connection",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsToggleConnection(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecConnectionConnectionExistsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "connection-exists <uuid>",
		Short: "ConnectionExists ipsec connection",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsConnectionExists(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecConnectionIsEnabledCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "is-enabled",
		Short: "IsEnabled ipsec connection",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsIsEnabled(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecConnectionSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set ipsec connection",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecConnectionSwanctlCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "swanctl",
		Short: "Swanctl ipsec connection",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsSwanctl(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// ipsecLocalColumns defines table columns for the Local resource.
var ipsecLocalColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Local); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Local); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "CONNECTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Local); ok {
			return fmt.Sprint(v.Connection)
		}
		return ""
	}},
	{Header: "ROUND", Extract: func(row any) string {
		if v, ok := row.(sdk.Local); ok {
			return fmt.Sprint(v.Round)
		}
		return ""
	}},
	{Header: "AUTH", Extract: func(row any) string {
		if v, ok := row.(sdk.Local); ok {
			return fmt.Sprint(v.Auth)
		}
		return ""
	}},
	{Header: "ID", Extract: func(row any) string {
		if v, ok := row.(sdk.Local); ok {
			return fmt.Sprint(v.Id)
		}
		return ""
	}},
	{Header: "EAP ID", Extract: func(row any) string {
		if v, ok := row.(sdk.Local); ok {
			return fmt.Sprint(v.EapId)
		}
		return ""
	}},
	{Header: "CERTS", Extract: func(row any) string {
		if v, ok := row.(sdk.Local); ok {
			return fmt.Sprint(v.Certs)
		}
		return ""
	}},
}

func newIpsecLocalCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "local",
		Short: "Manage ipsec local resources",
	}
	cmd.AddCommand(newIpsecLocalCreateCmd())
	cmd.AddCommand(newIpsecLocalDeleteCmd())
	cmd.AddCommand(newIpsecLocalGetCmd())
	cmd.AddCommand(newIpsecLocalListCmd())
	cmd.AddCommand(newIpsecLocalUpdateCmd())
	cmd.AddCommand(newIpsecLocalToggleCmd())
	return cmd
}

func newIpsecLocalCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ipsec local",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Local
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsAddLocal(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecLocalDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ipsec local",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsDelLocal(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecLocalGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec local",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsGetLocal(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecLocalListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ipsec local resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ConnectionsSearchLocal(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, ipsecLocalColumns)
		},
	}
}

func newIpsecLocalUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update",
		Short: "Update ipsec local",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Local
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsSetLocal(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecLocalToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ipsec local",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsToggleLocal(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// ipsecRemoteColumns defines table columns for the Remote resource.
var ipsecRemoteColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Remote); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Remote); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "CONNECTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Remote); ok {
			return fmt.Sprint(v.Connection)
		}
		return ""
	}},
	{Header: "ROUND", Extract: func(row any) string {
		if v, ok := row.(sdk.Remote); ok {
			return fmt.Sprint(v.Round)
		}
		return ""
	}},
	{Header: "AUTH", Extract: func(row any) string {
		if v, ok := row.(sdk.Remote); ok {
			return fmt.Sprint(v.Auth)
		}
		return ""
	}},
	{Header: "ID", Extract: func(row any) string {
		if v, ok := row.(sdk.Remote); ok {
			return fmt.Sprint(v.Id)
		}
		return ""
	}},
	{Header: "EAP ID", Extract: func(row any) string {
		if v, ok := row.(sdk.Remote); ok {
			return fmt.Sprint(v.EapId)
		}
		return ""
	}},
	{Header: "GROUPS", Extract: func(row any) string {
		if v, ok := row.(sdk.Remote); ok {
			return fmt.Sprint(v.Groups)
		}
		return ""
	}},
}

func newIpsecRemoteCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "remote",
		Short: "Manage ipsec remote resources",
	}
	cmd.AddCommand(newIpsecRemoteCreateCmd())
	cmd.AddCommand(newIpsecRemoteDeleteCmd())
	cmd.AddCommand(newIpsecRemoteGetCmd())
	cmd.AddCommand(newIpsecRemoteListCmd())
	cmd.AddCommand(newIpsecRemoteUpdateCmd())
	cmd.AddCommand(newIpsecRemoteToggleCmd())
	return cmd
}

func newIpsecRemoteCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ipsec remote",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Remote
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsAddRemote(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecRemoteDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ipsec remote",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsDelRemote(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecRemoteGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec remote",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsGetRemote(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecRemoteListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ipsec remote resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ConnectionsSearchRemote(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, ipsecRemoteColumns)
		},
	}
}

func newIpsecRemoteUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update",
		Short: "Update ipsec remote",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Remote
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsSetRemote(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecRemoteToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ipsec remote",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ConnectionsToggleRemote(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// ipsecKeyPairsColumns defines table columns for the KeyPairs resource.
var ipsecKeyPairsColumns = []cli.Column{
	{Header: "NAME", Extract: func(row any) string {
		if v, ok := row.(sdk.KeyPair); ok {
			return fmt.Sprint(v.Name)
		}
		return ""
	}},
	{Header: "KEYTYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.KeyPair); ok {
			return fmt.Sprint(v.KeyType)
		}
		return ""
	}},
	{Header: "PUBLICKEY", Extract: func(row any) string {
		if v, ok := row.(sdk.KeyPair); ok {
			return fmt.Sprint(v.PublicKey)
		}
		return ""
	}},
	{Header: "PRIVATEKEY", Extract: func(row any) string {
		if v, ok := row.(sdk.KeyPair); ok {
			return fmt.Sprint(v.PrivateKey)
		}
		return ""
	}},
	{Header: "KEYSIZE", Extract: func(row any) string {
		if v, ok := row.(sdk.KeyPair); ok {
			return fmt.Sprint(v.KeySize)
		}
		return ""
	}},
	{Header: "KEYFINGERPRINT", Extract: func(row any) string {
		if v, ok := row.(sdk.KeyPair); ok {
			return fmt.Sprint(v.KeyFingerprint)
		}
		return ""
	}},
}

func newIpsecKeyPairsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "key-pairs",
		Short: "Manage ipsec key-pairs resources",
	}
	cmd.AddCommand(newIpsecKeyPairsCreateCmd())
	cmd.AddCommand(newIpsecKeyPairsDeleteCmd())
	cmd.AddCommand(newIpsecKeyPairsGenKeyPairCmd())
	cmd.AddCommand(newIpsecKeyPairsGetCmd())
	cmd.AddCommand(newIpsecKeyPairsListCmd())
	cmd.AddCommand(newIpsecKeyPairsSetCmd())
	cmd.AddCommand(newIpsecKeyPairsUpdateCmd())
	return cmd
}

func newIpsecKeyPairsCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ipsec key-pairs",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.KeyPair
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.KeyPairsAddItem(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecKeyPairsDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ipsec key-pairs",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.KeyPairsDelItem(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecKeyPairsGenKeyPairCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "gen-key-pair <type>",
		Short: "GenKeyPair ipsec key-pairs",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.KeyPairsGenKeyPair(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecKeyPairsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec key-pairs",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.KeyPairsGetItem(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecKeyPairsListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ipsec key-pairs resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.KeyPairsSearchItem(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, ipsecKeyPairsColumns)
		},
	}
}

func newIpsecKeyPairsSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set ipsec key-pairs",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.KeyPairsSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecKeyPairsUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update",
		Short: "Update ipsec key-pairs",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.KeyPair
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.KeyPairsSetItem(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecLeasesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "leases",
		Short: "Manage ipsec leases resources",
	}
	cmd.AddCommand(newIpsecLeasesPoolsCmd())
	cmd.AddCommand(newIpsecLeasesSearchCmd())
	return cmd
}

func newIpsecLeasesPoolsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "pools",
		Short: "Pools ipsec leases",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.LeasesPools(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecLeasesSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search ipsec leases",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.LeasesSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecLegacySubsystemCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "legacy-subsystem",
		Short: "Manage ipsec legacy-subsystem resources",
	}
	cmd.AddCommand(newIpsecLegacySubsystemApplyConfigCmd())
	cmd.AddCommand(newIpsecLegacySubsystemStatusCmd())
	return cmd
}

func newIpsecLegacySubsystemApplyConfigCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "apply-config",
		Short: "ApplyConfig ipsec legacy-subsystem",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.LegacySubsystemApplyConfig(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecLegacySubsystemStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status ipsec legacy-subsystem",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.LegacySubsystemStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecManualSpdCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "manual-spd",
		Short: "Manage ipsec manual-spd resources",
	}
	cmd.AddCommand(newIpsecManualSpdAddCmd())
	cmd.AddCommand(newIpsecManualSpdDelCmd())
	cmd.AddCommand(newIpsecManualSpdGetCmd())
	cmd.AddCommand(newIpsecManualSpdSearchCmd())
	cmd.AddCommand(newIpsecManualSpdSetCmd())
	cmd.AddCommand(newIpsecManualSpdToggleCmd())
	return cmd
}

func newIpsecManualSpdAddCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "add",
		Short: "Add ipsec manual-spd",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ManualSpdAdd(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecManualSpdDelCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del <uuid>",
		Short: "Del ipsec manual-spd",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ManualSpdDel(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecManualSpdGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec manual-spd",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ManualSpdGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecManualSpdSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search ipsec manual-spd",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ManualSpdSearch(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecManualSpdSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set ipsec manual-spd",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ManualSpdSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecManualSpdToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ipsec manual-spd",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ManualSpdToggle(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPoolsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "pools",
		Short: "Manage ipsec pools resources",
	}
	cmd.AddCommand(newIpsecPoolsAddCmd())
	cmd.AddCommand(newIpsecPoolsDelCmd())
	cmd.AddCommand(newIpsecPoolsGetCmd())
	cmd.AddCommand(newIpsecPoolsSearchCmd())
	cmd.AddCommand(newIpsecPoolsSetCmd())
	cmd.AddCommand(newIpsecPoolsToggleCmd())
	return cmd
}

func newIpsecPoolsAddCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "add",
		Short: "Add ipsec pools",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PoolsAdd(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPoolsDelCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del <uuid>",
		Short: "Del ipsec pools",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PoolsDel(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPoolsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec pools",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PoolsGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPoolsSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search ipsec pools",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PoolsSearch(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPoolsSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set ipsec pools",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PoolsSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPoolsToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ipsec pools",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PoolsToggle(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// ipsecPreSharedKeysColumns defines table columns for the PreSharedKeys resource.
var ipsecPreSharedKeysColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.PreSharedKey); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "IDENT", Extract: func(row any) string {
		if v, ok := row.(sdk.PreSharedKey); ok {
			return fmt.Sprint(v.Ident)
		}
		return ""
	}},
	{Header: "REMOTE IDENT", Extract: func(row any) string {
		if v, ok := row.(sdk.PreSharedKey); ok {
			return fmt.Sprint(v.RemoteIdent)
		}
		return ""
	}},
	{Header: "KEYTYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.PreSharedKey); ok {
			return fmt.Sprint(v.KeyType)
		}
		return ""
	}},
	{Header: "KEY", Extract: func(row any) string {
		if v, ok := row.(sdk.PreSharedKey); ok {
			return fmt.Sprint(v.Key)
		}
		return ""
	}},
}

func newIpsecPreSharedKeysCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "pre-shared-keys",
		Short: "Manage ipsec pre-shared-keys resources",
	}
	cmd.AddCommand(newIpsecPreSharedKeysCreateCmd())
	cmd.AddCommand(newIpsecPreSharedKeysDeleteCmd())
	cmd.AddCommand(newIpsecPreSharedKeysGetCmd())
	cmd.AddCommand(newIpsecPreSharedKeysListCmd())
	cmd.AddCommand(newIpsecPreSharedKeysSetCmd())
	cmd.AddCommand(newIpsecPreSharedKeysUpdateCmd())
	return cmd
}

func newIpsecPreSharedKeysCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create ipsec pre-shared-keys",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.PreSharedKey
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.PreSharedKeysAddItem(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecPreSharedKeysDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete ipsec pre-shared-keys",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PreSharedKeysDelItem(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecPreSharedKeysGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec pre-shared-keys",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PreSharedKeysGetItem(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newIpsecPreSharedKeysListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List ipsec pre-shared-keys resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.PreSharedKeysSearchItem(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, ipsecPreSharedKeysColumns)
		},
	}
}

func newIpsecPreSharedKeysSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set ipsec pre-shared-keys",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PreSharedKeysSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPreSharedKeysUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update",
		Short: "Update ipsec pre-shared-keys",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.PreSharedKey
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.PreSharedKeysSetItem(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newIpsecSadCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "sad",
		Short: "Manage ipsec sad resources",
	}
	cmd.AddCommand(newIpsecSadDeleteCmd())
	cmd.AddCommand(newIpsecSadSearchCmd())
	return cmd
}

func newIpsecSadDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <id>",
		Short: "Delete ipsec sad",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SadDelete(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecSadSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search ipsec sad",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SadSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage ipsec service resources",
	}
	cmd.AddCommand(newIpsecServiceReconfigureCmd())
	cmd.AddCommand(newIpsecServiceRestartCmd())
	cmd.AddCommand(newIpsecServiceStartCmd())
	cmd.AddCommand(newIpsecServiceStatusCmd())
	cmd.AddCommand(newIpsecServiceStopCmd())
	return cmd
}

func newIpsecServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure ipsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart ipsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start ipsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecServiceStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status ipsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop ipsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecSessionsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "sessions",
		Short: "Manage ipsec sessions resources",
	}
	cmd.AddCommand(newIpsecSessionsConnectCmd())
	cmd.AddCommand(newIpsecSessionsDisconnectCmd())
	return cmd
}

func newIpsecSessionsConnectCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "connect <id>",
		Short: "Connect ipsec sessions",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SessionsConnect(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecSessionsDisconnectCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "disconnect <id>",
		Short: "Disconnect ipsec sessions",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SessionsDisconnect(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPhase1Cmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "phase1",
		Short: "Manage ipsec phase1 resources",
	}
	cmd.AddCommand(newIpsecPhase1SearchPhase1Cmd())
	cmd.AddCommand(newIpsecPhase1DelPhase1Cmd())
	cmd.AddCommand(newIpsecPhase1TogglePhase1Cmd())
	return cmd
}

func newIpsecPhase1SearchPhase1Cmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search-phase1",
		Short: "SearchPhase1 ipsec phase1",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SessionsSearchPhase1(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPhase1DelPhase1Cmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del-phase1 <ikeid>",
		Short: "DelPhase1 ipsec phase1",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunnelDelPhase1(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPhase1TogglePhase1Cmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle-phase1 <ikeid>",
		Short: "TogglePhase1 ipsec phase1",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunnelTogglePhase1(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPhase2Cmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "phase2",
		Short: "Manage ipsec phase2 resources",
	}
	cmd.AddCommand(newIpsecPhase2SearchPhase2Cmd())
	cmd.AddCommand(newIpsecPhase2DelPhase2Cmd())
	cmd.AddCommand(newIpsecPhase2TogglePhase2Cmd())
	return cmd
}

func newIpsecPhase2SearchPhase2Cmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search-phase2",
		Short: "SearchPhase2 ipsec phase2",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SessionsSearchPhase2(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPhase2DelPhase2Cmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del-phase2 <seqid>",
		Short: "DelPhase2 ipsec phase2",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunnelDelPhase2(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecPhase2TogglePhase2Cmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle-phase2 <seqid>",
		Short: "TogglePhase2 ipsec phase2",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunnelTogglePhase2(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecSettingsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "settings",
		Short: "Manage ipsec settings resources",
	}
	cmd.AddCommand(newIpsecSettingsGetCmd())
	cmd.AddCommand(newIpsecSettingsSetCmd())
	return cmd
}

func newIpsecSettingsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecSettingsSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set ipsec settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecSpdCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "spd",
		Short: "Manage ipsec spd resources",
	}
	cmd.AddCommand(newIpsecSpdDeleteCmd())
	cmd.AddCommand(newIpsecSpdSearchCmd())
	return cmd
}

func newIpsecSpdDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <id>",
		Short: "Delete ipsec spd",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SpdDelete(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecSpdSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search ipsec spd",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SpdSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecTunnelCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "tunnel",
		Short: "Manage ipsec tunnel resources",
	}
	cmd.AddCommand(newIpsecTunnelToggleCmd())
	return cmd
}

func newIpsecTunnelToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle",
		Short: "Toggle ipsec tunnel",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunnelToggle(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecVtiCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "vti",
		Short: "Manage ipsec vti resources",
	}
	cmd.AddCommand(newIpsecVtiAddCmd())
	cmd.AddCommand(newIpsecVtiDelCmd())
	cmd.AddCommand(newIpsecVtiGetCmd())
	cmd.AddCommand(newIpsecVtiSearchCmd())
	cmd.AddCommand(newIpsecVtiSetCmd())
	cmd.AddCommand(newIpsecVtiToggleCmd())
	return cmd
}

func newIpsecVtiAddCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "add",
		Short: "Add ipsec vti",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.VtiAdd(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecVtiDelCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del <uuid>",
		Short: "Del ipsec vti",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.VtiDel(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecVtiGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get ipsec vti",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.VtiGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecVtiSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search ipsec vti",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.VtiSearch(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecVtiSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set ipsec vti",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.VtiSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newIpsecVtiToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle ipsec vti",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.VtiToggle(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

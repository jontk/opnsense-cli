// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/unbound"
	"github.com/spf13/cobra"
)

func init() {
	registerUnbound()
}

func registerUnbound() {
	moduleCmd := &cobra.Command{
		Use:   "unbound",
		Short: "Manage unbound resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			if len(args) == 0 {
				return cmd.Help()
			}
			msg := fmt.Sprintf("unknown command %q for %q", args[0], cmd.CommandPath())
			if sugg := cmd.SuggestionsFor(args[0]); len(sugg) > 0 {
				msg += "\n\nDid you mean this?"
				for _, s := range sugg {
					msg += "\n\t" + s
				}
			}
			return fmt.Errorf("%s\n\nRun '%s --help' for usage.", msg, cmd.CommandPath())
		},
	}
	moduleCmd.AddCommand(newUnboundDiagnosticsCmd())
	moduleCmd.AddCommand(newUnboundOverviewCmd())
	moduleCmd.AddCommand(newUnboundPoliciesCmd())
	moduleCmd.AddCommand(newUnboundQueriesCmd())
	moduleCmd.AddCommand(newUnboundServiceCmd())
	moduleCmd.AddCommand(newUnboundAclCmd())
	moduleCmd.AddCommand(newUnboundDnsblCmd())
	moduleCmd.AddCommand(newUnboundForwardCmd())
	moduleCmd.AddCommand(newUnboundHostAliasCmd())
	moduleCmd.AddCommand(newUnboundHostOverrideCmd())
	moduleCmd.AddCommand(newUnboundSettingsCmd())
	moduleCmd.AddCommand(newUnboundNameserversCmd())
	cli.Root.AddCommand(moduleCmd)
}

func newUnboundDiagnosticsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "diagnostics",
		Short: "Manage unbound diagnostics resources",
	}
	cmd.AddCommand(newUnboundDiagnosticsDumpcacheCmd())
	cmd.AddCommand(newUnboundDiagnosticsDumpinfraCmd())
	cmd.AddCommand(newUnboundDiagnosticsListinsecureCmd())
	cmd.AddCommand(newUnboundDiagnosticsListlocaldataCmd())
	cmd.AddCommand(newUnboundDiagnosticsListlocalzonesCmd())
	cmd.AddCommand(newUnboundDiagnosticsStatsCmd())
	cmd.AddCommand(newUnboundDiagnosticsTestBlocklistCmd())
	return cmd
}

func newUnboundDiagnosticsDumpcacheCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "dumpcache",
		Short: "Dumpcache unbound diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsDumpcache(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundDiagnosticsDumpinfraCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "dumpinfra",
		Short: "Dumpinfra unbound diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsDumpinfra(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundDiagnosticsListinsecureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "listinsecure",
		Short: "Listinsecure unbound diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsListinsecure(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundDiagnosticsListlocaldataCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "listlocaldata",
		Short: "Listlocaldata unbound diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsListlocaldata(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundDiagnosticsListlocalzonesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "listlocalzones",
		Short: "Listlocalzones unbound diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsListlocalzones(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundDiagnosticsStatsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stats",
		Short: "Stats unbound diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsStats(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundDiagnosticsTestBlocklistCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "test-blocklist",
		Short: "TestBlocklist unbound diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsTestBlocklist(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundOverviewCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "overview",
		Short: "Manage unbound overview resources",
	}
	cmd.AddCommand(newUnboundOverviewRollingCmd())
	cmd.AddCommand(newUnboundOverviewIsBlockListEnabledCmd())
	cmd.AddCommand(newUnboundOverviewIsEnabledCmd())
	cmd.AddCommand(newUnboundOverviewTotalsCmd())
	return cmd
}

func newUnboundOverviewRollingCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "rolling <timeperiod>",
		Short: "Rolling unbound overview",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.OverviewRolling(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundOverviewIsBlockListEnabledCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "is-block-list-enabled",
		Short: "IsBlockListEnabled unbound overview",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.OverviewIsBlockListEnabled(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundOverviewIsEnabledCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "is-enabled",
		Short: "IsEnabled unbound overview",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.OverviewIsEnabled(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundOverviewTotalsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "totals <maximum>",
		Short: "Totals unbound overview",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.OverviewTotals(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundPoliciesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "policies",
		Short: "Manage unbound policies resources",
	}
	cmd.AddCommand(newUnboundPoliciesGetPoliciesCmd())
	return cmd
}

func newUnboundPoliciesGetPoliciesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-policies",
		Short: "GetPolicies unbound policies",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.OverviewGetPolicies(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundQueriesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "queries",
		Short: "Manage unbound queries resources",
	}
	cmd.AddCommand(newUnboundQueriesSearchQueriesCmd())
	return cmd
}

func newUnboundQueriesSearchQueriesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search-queries",
		Short: "SearchQueries unbound queries",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.OverviewSearchQueries(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage unbound service resources",
	}
	cmd.AddCommand(newUnboundServiceDnsblCmd())
	cmd.AddCommand(newUnboundServiceReconfigureCmd())
	cmd.AddCommand(newUnboundServiceReconfigureGeneralCmd())
	cmd.AddCommand(newUnboundServiceRestartCmd())
	cmd.AddCommand(newUnboundServiceStartCmd())
	cmd.AddCommand(newUnboundServiceStatusCmd())
	cmd.AddCommand(newUnboundServiceStopCmd())
	return cmd
}

func newUnboundServiceDnsblCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "dnsbl",
		Short: "Dnsbl unbound service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceDnsbl(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure unbound service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundServiceReconfigureGeneralCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure-general",
		Short: "ReconfigureGeneral unbound service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigureGeneral(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart unbound service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start unbound service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundServiceStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status unbound service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop unbound service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// unboundAclColumns defines table columns for the Acl resource.
var unboundAclColumns = []cli.Column{
	{Header: "NAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Acl); ok {
			return fmt.Sprint(v.Name)
		}
		return ""
	}},
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Acl); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Acl); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "ACTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Acl); ok {
			return fmt.Sprint(v.Action)
		}
		return ""
	}},
	{Header: "NETWORKS", Extract: func(row any) string {
		if v, ok := row.(sdk.Acl); ok {
			return fmt.Sprint(v.Networks)
		}
		return ""
	}},
}

func newUnboundAclCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "acl",
		Short: "Manage unbound acl resources",
	}
	cmd.AddCommand(newUnboundAclCreateCmd())
	cmd.AddCommand(newUnboundAclDeleteCmd())
	cmd.AddCommand(newUnboundAclGetCmd())
	cmd.AddCommand(newUnboundAclListCmd())
	cmd.AddCommand(newUnboundAclUpdateCmd())
	cmd.AddCommand(newUnboundAclToggleCmd())
	return cmd
}

func newUnboundAclCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create unbound acl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Acl
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddAcl(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundAclDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete unbound acl",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelAcl(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundAclGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get unbound acl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetAcl(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundAclListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List unbound acl resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchAcl(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, unboundAclColumns)
		},
	}
}

func newUnboundAclUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update unbound acl",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Acl
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetAcl(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundAclToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle unbound acl",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleAcl(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// unboundDnsblColumns defines table columns for the Dnsbl resource.
var unboundDnsblColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Blocklist); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Blocklist); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "TYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Blocklist); ok {
			return fmt.Sprint(v.Type)
		}
		return ""
	}},
	{Header: "ADDRESS", Extract: func(row any) string {
		if v, ok := row.(sdk.Blocklist); ok {
			return fmt.Sprint(v.Address)
		}
		return ""
	}},
	{Header: "LISTS", Extract: func(row any) string {
		if v, ok := row.(sdk.Blocklist); ok {
			return fmt.Sprint(v.Lists)
		}
		return ""
	}},
	{Header: "ALLOWLISTS", Extract: func(row any) string {
		if v, ok := row.(sdk.Blocklist); ok {
			return fmt.Sprint(v.Allowlists)
		}
		return ""
	}},
	{Header: "BLOCKLISTS", Extract: func(row any) string {
		if v, ok := row.(sdk.Blocklist); ok {
			return fmt.Sprint(v.Blocklists)
		}
		return ""
	}},
	{Header: "WILDCARDS", Extract: func(row any) string {
		if v, ok := row.(sdk.Blocklist); ok {
			return fmt.Sprint(v.Wildcards)
		}
		return ""
	}},
}

func newUnboundDnsblCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "dnsbl",
		Short: "Manage unbound dnsbl resources",
	}
	cmd.AddCommand(newUnboundDnsblCreateCmd())
	cmd.AddCommand(newUnboundDnsblDeleteCmd())
	cmd.AddCommand(newUnboundDnsblGetCmd())
	cmd.AddCommand(newUnboundDnsblListCmd())
	cmd.AddCommand(newUnboundDnsblUpdateCmd())
	cmd.AddCommand(newUnboundDnsblToggleCmd())
	return cmd
}

func newUnboundDnsblCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create unbound dnsbl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Blocklist
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddDnsbl(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundDnsblDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete unbound dnsbl",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelDnsbl(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundDnsblGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get unbound dnsbl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetDnsbl(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundDnsblListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List unbound dnsbl resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchDnsbl(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, unboundDnsblColumns)
		},
	}
}

func newUnboundDnsblUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update unbound dnsbl",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Blocklist
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetDnsbl(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundDnsblToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle unbound dnsbl",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleDnsbl(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// unboundForwardColumns defines table columns for the Forward resource.
var unboundForwardColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Forwarding); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
}

func newUnboundForwardCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "forward",
		Short: "Manage unbound forward resources",
	}
	cmd.AddCommand(newUnboundForwardCreateCmd())
	cmd.AddCommand(newUnboundForwardDeleteCmd())
	cmd.AddCommand(newUnboundForwardGetCmd())
	cmd.AddCommand(newUnboundForwardListCmd())
	cmd.AddCommand(newUnboundForwardUpdateCmd())
	cmd.AddCommand(newUnboundForwardToggleCmd())
	return cmd
}

func newUnboundForwardCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create unbound forward",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Forwarding
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddForward(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundForwardDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete unbound forward",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelForward(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundForwardGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get unbound forward",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetForward(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundForwardListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List unbound forward resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchForward(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, unboundForwardColumns)
		},
	}
}

func newUnboundForwardUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update unbound forward",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Forwarding
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetForward(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundForwardToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle unbound forward",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleForward(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// unboundHostAliasColumns defines table columns for the HostAlias resource.
var unboundHostAliasColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Alias); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Alias); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "HOST", Extract: func(row any) string {
		if v, ok := row.(sdk.Alias); ok {
			return fmt.Sprint(v.Host)
		}
		return ""
	}},
	{Header: "HOSTNAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Alias); ok {
			return fmt.Sprint(v.Hostname)
		}
		return ""
	}},
	{Header: "DOMAIN", Extract: func(row any) string {
		if v, ok := row.(sdk.Alias); ok {
			return fmt.Sprint(v.Domain)
		}
		return ""
	}},
}

func newUnboundHostAliasCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "host-alias",
		Short: "Manage unbound host-alias resources",
	}
	cmd.AddCommand(newUnboundHostAliasCreateCmd())
	cmd.AddCommand(newUnboundHostAliasDeleteCmd())
	cmd.AddCommand(newUnboundHostAliasGetCmd())
	cmd.AddCommand(newUnboundHostAliasListCmd())
	cmd.AddCommand(newUnboundHostAliasUpdateCmd())
	cmd.AddCommand(newUnboundHostAliasToggleCmd())
	return cmd
}

func newUnboundHostAliasCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create unbound host-alias",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Alias
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddHostAlias(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundHostAliasDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete unbound host-alias",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelHostAlias(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundHostAliasGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get unbound host-alias",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetHostAlias(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundHostAliasListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List unbound host-alias resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchHostAlias(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, unboundHostAliasColumns)
		},
	}
}

func newUnboundHostAliasUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update unbound host-alias",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Alias
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetHostAlias(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundHostAliasToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle unbound host-alias",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleHostAlias(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// unboundHostOverrideColumns defines table columns for the HostOverride resource.
var unboundHostOverrideColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Host); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Host); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "HOSTNAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Host); ok {
			return fmt.Sprint(v.Hostname)
		}
		return ""
	}},
	{Header: "DOMAIN", Extract: func(row any) string {
		if v, ok := row.(sdk.Host); ok {
			return fmt.Sprint(v.Domain)
		}
		return ""
	}},
	{Header: "RR", Extract: func(row any) string {
		if v, ok := row.(sdk.Host); ok {
			return fmt.Sprint(v.Rr)
		}
		return ""
	}},
	{Header: "MXPRIO", Extract: func(row any) string {
		if v, ok := row.(sdk.Host); ok {
			return fmt.Sprint(v.Mxprio)
		}
		return ""
	}},
	{Header: "MX", Extract: func(row any) string {
		if v, ok := row.(sdk.Host); ok {
			return fmt.Sprint(v.Mx)
		}
		return ""
	}},
	{Header: "TTL", Extract: func(row any) string {
		if v, ok := row.(sdk.Host); ok {
			return fmt.Sprint(v.Ttl)
		}
		return ""
	}},
}

func newUnboundHostOverrideCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "host-override",
		Short: "Manage unbound host-override resources",
	}
	cmd.AddCommand(newUnboundHostOverrideCreateCmd())
	cmd.AddCommand(newUnboundHostOverrideDeleteCmd())
	cmd.AddCommand(newUnboundHostOverrideGetCmd())
	cmd.AddCommand(newUnboundHostOverrideListCmd())
	cmd.AddCommand(newUnboundHostOverrideUpdateCmd())
	cmd.AddCommand(newUnboundHostOverrideToggleCmd())
	return cmd
}

func newUnboundHostOverrideCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create unbound host-override",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Host
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddHostOverride(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundHostOverrideDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete unbound host-override",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelHostOverride(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundHostOverrideGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get unbound host-override",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetHostOverride(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundHostOverrideListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List unbound host-override resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchHostOverride(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, unboundHostOverrideColumns)
		},
	}
}

func newUnboundHostOverrideUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update unbound host-override",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Host
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetHostOverride(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newUnboundHostOverrideToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle unbound host-override",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleHostOverride(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newUnboundSettingsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "settings",
		Short: "Manage unbound settings resources",
	}
	cmd.AddCommand(newUnboundSettingsGetCmd())
	cmd.AddCommand(newUnboundSettingsSetCmd())
	cmd.AddCommand(newUnboundSettingsUpdateBlocklistCmd())
	return cmd
}

func newUnboundSettingsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get unbound settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundSettingsSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set unbound settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundSettingsUpdateBlocklistCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "update-blocklist",
		Short: "UpdateBlocklist unbound settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsUpdateBlocklist(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newUnboundNameserversCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "nameservers",
		Short: "Manage unbound nameservers resources",
	}
	cmd.AddCommand(newUnboundNameserversGetNameserversCmd())
	return cmd
}

func newUnboundNameserversGetNameserversCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-nameservers",
		Short: "GetNameservers unbound nameservers",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetNameservers(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

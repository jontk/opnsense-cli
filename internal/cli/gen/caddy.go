// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/caddy"
	"github.com/spf13/cobra"
)

func init() {
	registerCaddy()
}

func registerCaddy() {
	moduleCmd := &cobra.Command{
		Use:   "caddy",
		Short: "Manage caddy resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			if len(args) == 0 {
				return cmd.Help()
			}
			msg := fmt.Sprintf("unknown command %q for %q", args[0], cmd.CommandPath())
			if sugg := cmd.SuggestionsFor(args[0]); len(sugg) > 0 {
				msg += "\n\nDid you mean this?"
				for _, s := range sugg {
					msg += "\n\t" + s
				}
			}
			return fmt.Errorf("%s\n\nRun '%s --help' for usage.", msg, cmd.CommandPath())
		},
	}
	moduleCmd.AddCommand(newCaddyDiagnosticsCmd())
	moduleCmd.AddCommand(newCaddyGeneralCmd())
	moduleCmd.AddCommand(newCaddyAccessListCmd())
	moduleCmd.AddCommand(newCaddyBasicAuthCmd())
	moduleCmd.AddCommand(newCaddyHandleCmd())
	moduleCmd.AddCommand(newCaddyHeaderCmd())
	moduleCmd.AddCommand(newCaddyLayer4Cmd())
	moduleCmd.AddCommand(newCaddyLayer4OpenvpnCmd())
	moduleCmd.AddCommand(newCaddyReverseProxyCmd())
	moduleCmd.AddCommand(newCaddySubdomainCmd())
	moduleCmd.AddCommand(newCaddyAllReverseDomainsCmd())
	moduleCmd.AddCommand(newCaddyServiceCmd())
	cli.Root.AddCommand(moduleCmd)
}

func newCaddyDiagnosticsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "diagnostics",
		Short: "Manage caddy diagnostics resources",
	}
	cmd.AddCommand(newCaddyDiagnosticsCaddyfileCmd())
	cmd.AddCommand(newCaddyDiagnosticsConfigCmd())
	cmd.AddCommand(newCaddyDiagnosticsGetCmd())
	cmd.AddCommand(newCaddyDiagnosticsSetCmd())
	return cmd
}

func newCaddyDiagnosticsCaddyfileCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "caddyfile",
		Short: "Caddyfile caddy diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsCaddyfile(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyDiagnosticsConfigCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "config",
		Short: "Config caddy diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsConfig(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyDiagnosticsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyDiagnosticsSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set caddy diagnostics",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DiagnosticsSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyGeneralCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "general",
		Short: "Manage caddy general resources",
	}
	cmd.AddCommand(newCaddyGeneralGetCmd())
	cmd.AddCommand(newCaddyGeneralSetCmd())
	return cmd
}

func newCaddyGeneralGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy general",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.GeneralGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyGeneralSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set caddy general",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.GeneralSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// caddyAccessListColumns defines table columns for the AccessList resource.
var caddyAccessListColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Accesslist); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "ACCESSLISTNAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Accesslist); ok {
			return fmt.Sprint(v.AccesslistName)
		}
		return ""
	}},
	{Header: "CLIENTIPS", Extract: func(row any) string {
		if v, ok := row.(sdk.Accesslist); ok {
			return fmt.Sprint(v.ClientIps)
		}
		return ""
	}},
	{Header: "ACCESSLISTINVERT", Extract: func(row any) string {
		if v, ok := row.(sdk.Accesslist); ok {
			return fmt.Sprint(v.AccesslistInvert)
		}
		return ""
	}},
	{Header: "HTTPRESPONSECODE", Extract: func(row any) string {
		if v, ok := row.(sdk.Accesslist); ok {
			return fmt.Sprint(v.HttpResponseCode)
		}
		return ""
	}},
	{Header: "HTTPRESPONSEMESSAGE", Extract: func(row any) string {
		if v, ok := row.(sdk.Accesslist); ok {
			return fmt.Sprint(v.HttpResponseMessage)
		}
		return ""
	}},
	{Header: "REQUESTMATCHER", Extract: func(row any) string {
		if v, ok := row.(sdk.Accesslist); ok {
			return fmt.Sprint(v.RequestMatcher)
		}
		return ""
	}},
}

func newCaddyAccessListCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "access-list",
		Short: "Manage caddy access-list resources",
	}
	cmd.AddCommand(newCaddyAccessListCreateCmd())
	cmd.AddCommand(newCaddyAccessListDeleteCmd())
	cmd.AddCommand(newCaddyAccessListGetCmd())
	cmd.AddCommand(newCaddyAccessListListCmd())
	cmd.AddCommand(newCaddyAccessListUpdateCmd())
	return cmd
}

func newCaddyAccessListCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create caddy access-list",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Accesslist
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyAddAccessList(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyAccessListDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete caddy access-list",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyDelAccessList(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyAccessListGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy access-list",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetAccessList(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyAccessListListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List caddy access-list resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ReverseProxySearchAccessList(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, caddyAccessListColumns)
		},
	}
}

func newCaddyAccessListUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update caddy access-list",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Accesslist
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySetAccessList(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

// caddyBasicAuthColumns defines table columns for the BasicAuth resource.
var caddyBasicAuthColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Basicauth); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "BASICAUTHUSER", Extract: func(row any) string {
		if v, ok := row.(sdk.Basicauth); ok {
			return fmt.Sprint(v.Basicauthuser)
		}
		return ""
	}},
	{Header: "BASICAUTHPASS", Extract: func(row any) string {
		if v, ok := row.(sdk.Basicauth); ok {
			return fmt.Sprint(v.Basicauthpass)
		}
		return ""
	}},
}

func newCaddyBasicAuthCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "basic-auth",
		Short: "Manage caddy basic-auth resources",
	}
	cmd.AddCommand(newCaddyBasicAuthCreateCmd())
	cmd.AddCommand(newCaddyBasicAuthDeleteCmd())
	cmd.AddCommand(newCaddyBasicAuthGetCmd())
	cmd.AddCommand(newCaddyBasicAuthListCmd())
	cmd.AddCommand(newCaddyBasicAuthUpdateCmd())
	return cmd
}

func newCaddyBasicAuthCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create caddy basic-auth",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Basicauth
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyAddBasicAuth(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyBasicAuthDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete caddy basic-auth",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyDelBasicAuth(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyBasicAuthGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy basic-auth",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetBasicAuth(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyBasicAuthListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List caddy basic-auth resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ReverseProxySearchBasicAuth(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, caddyBasicAuthColumns)
		},
	}
}

func newCaddyBasicAuthUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update caddy basic-auth",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Basicauth
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySetBasicAuth(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

// caddyHandleColumns defines table columns for the Handle resource.
var caddyHandleColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Handle); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Handle); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "REVERSE", Extract: func(row any) string {
		if v, ok := row.(sdk.Handle); ok {
			return fmt.Sprint(v.Reverse)
		}
		return ""
	}},
	{Header: "SUBDOMAIN", Extract: func(row any) string {
		if v, ok := row.(sdk.Handle); ok {
			return fmt.Sprint(v.Subdomain)
		}
		return ""
	}},
	{Header: "HANDLETYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Handle); ok {
			return fmt.Sprint(v.HandleType)
		}
		return ""
	}},
	{Header: "HANDLEPATH", Extract: func(row any) string {
		if v, ok := row.(sdk.Handle); ok {
			return fmt.Sprint(v.HandlePath)
		}
		return ""
	}},
	{Header: "ACCESSLIST", Extract: func(row any) string {
		if v, ok := row.(sdk.Handle); ok {
			return fmt.Sprint(v.Accesslist)
		}
		return ""
	}},
	{Header: "BASICAUTH", Extract: func(row any) string {
		if v, ok := row.(sdk.Handle); ok {
			return fmt.Sprint(v.Basicauth)
		}
		return ""
	}},
}

func newCaddyHandleCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "handle",
		Short: "Manage caddy handle resources",
	}
	cmd.AddCommand(newCaddyHandleCreateCmd())
	cmd.AddCommand(newCaddyHandleDeleteCmd())
	cmd.AddCommand(newCaddyHandleGetCmd())
	cmd.AddCommand(newCaddyHandleListCmd())
	cmd.AddCommand(newCaddyHandleUpdateCmd())
	cmd.AddCommand(newCaddyHandleToggleCmd())
	return cmd
}

func newCaddyHandleCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create caddy handle",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Handle
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyAddHandle(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyHandleDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete caddy handle",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyDelHandle(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyHandleGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy handle",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetHandle(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyHandleListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List caddy handle resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ReverseProxySearchHandle(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, caddyHandleColumns)
		},
	}
}

func newCaddyHandleUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update caddy handle",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Handle
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySetHandle(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyHandleToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle caddy handle",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyToggleHandle(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// caddyHeaderColumns defines table columns for the Header resource.
var caddyHeaderColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Header); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "HEADERUPDOWN", Extract: func(row any) string {
		if v, ok := row.(sdk.Header); ok {
			return fmt.Sprint(v.HeaderUpDown)
		}
		return ""
	}},
	{Header: "HEADERTYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Header); ok {
			return fmt.Sprint(v.HeaderType)
		}
		return ""
	}},
	{Header: "HEADERVALUE", Extract: func(row any) string {
		if v, ok := row.(sdk.Header); ok {
			return fmt.Sprint(v.HeaderValue)
		}
		return ""
	}},
	{Header: "HEADERREPLACE", Extract: func(row any) string {
		if v, ok := row.(sdk.Header); ok {
			return fmt.Sprint(v.HeaderReplace)
		}
		return ""
	}},
}

func newCaddyHeaderCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "header",
		Short: "Manage caddy header resources",
	}
	cmd.AddCommand(newCaddyHeaderCreateCmd())
	cmd.AddCommand(newCaddyHeaderDeleteCmd())
	cmd.AddCommand(newCaddyHeaderGetCmd())
	cmd.AddCommand(newCaddyHeaderListCmd())
	cmd.AddCommand(newCaddyHeaderUpdateCmd())
	return cmd
}

func newCaddyHeaderCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create caddy header",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Header
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyAddHeader(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyHeaderDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete caddy header",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyDelHeader(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyHeaderGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy header",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetHeader(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyHeaderListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List caddy header resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ReverseProxySearchHeader(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, caddyHeaderColumns)
		},
	}
}

func newCaddyHeaderUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update caddy header",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Header
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySetHeader(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

// caddyLayer4Columns defines table columns for the Layer4 resource.
var caddyLayer4Columns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "SEQUENCE", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4); ok {
			return fmt.Sprint(v.Sequence)
		}
		return ""
	}},
	{Header: "TYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4); ok {
			return fmt.Sprint(v.Type)
		}
		return ""
	}},
	{Header: "PROTOCOL", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4); ok {
			return fmt.Sprint(v.Protocol)
		}
		return ""
	}},
	{Header: "FROMPORT", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4); ok {
			return fmt.Sprint(v.FromPort)
		}
		return ""
	}},
	{Header: "FROMDOMAIN", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4); ok {
			return fmt.Sprint(v.FromDomain)
		}
		return ""
	}},
	{Header: "FROMOPENVPNMODES", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4); ok {
			return fmt.Sprint(v.FromOpenvpnModes)
		}
		return ""
	}},
}

func newCaddyLayer4Cmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "layer4",
		Short: "Manage caddy layer4 resources",
	}
	cmd.AddCommand(newCaddyLayer4CreateCmd())
	cmd.AddCommand(newCaddyLayer4DeleteCmd())
	cmd.AddCommand(newCaddyLayer4GetCmd())
	cmd.AddCommand(newCaddyLayer4ListCmd())
	cmd.AddCommand(newCaddyLayer4UpdateCmd())
	cmd.AddCommand(newCaddyLayer4ToggleCmd())
	return cmd
}

func newCaddyLayer4CreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create caddy layer4",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Layer4
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyAddLayer4(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyLayer4DeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete caddy layer4",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyDelLayer4(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyLayer4GetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy layer4",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetLayer4(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyLayer4ListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List caddy layer4 resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ReverseProxySearchLayer4(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, caddyLayer4Columns)
		},
	}
}

func newCaddyLayer4UpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update caddy layer4",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Layer4
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySetLayer4(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyLayer4ToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle caddy layer4",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyToggleLayer4(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// caddyLayer4OpenvpnColumns defines table columns for the Layer4Openvpn resource.
var caddyLayer4OpenvpnColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4openvpn); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "STATICKEY", Extract: func(row any) string {
		if v, ok := row.(sdk.Layer4openvpn); ok {
			return fmt.Sprint(v.StaticKey)
		}
		return ""
	}},
}

func newCaddyLayer4OpenvpnCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "layer4-openvpn",
		Short: "Manage caddy layer4-openvpn resources",
	}
	cmd.AddCommand(newCaddyLayer4OpenvpnCreateCmd())
	cmd.AddCommand(newCaddyLayer4OpenvpnDeleteCmd())
	cmd.AddCommand(newCaddyLayer4OpenvpnGetCmd())
	cmd.AddCommand(newCaddyLayer4OpenvpnListCmd())
	cmd.AddCommand(newCaddyLayer4OpenvpnUpdateCmd())
	cmd.AddCommand(newCaddyLayer4OpenvpnToggleCmd())
	return cmd
}

func newCaddyLayer4OpenvpnCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create caddy layer4-openvpn",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Layer4openvpn
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyAddLayer4Openvpn(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyLayer4OpenvpnDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete caddy layer4-openvpn",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyDelLayer4Openvpn(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyLayer4OpenvpnGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy layer4-openvpn",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetLayer4Openvpn(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyLayer4OpenvpnListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List caddy layer4-openvpn resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ReverseProxySearchLayer4Openvpn(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, caddyLayer4OpenvpnColumns)
		},
	}
}

func newCaddyLayer4OpenvpnUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update caddy layer4-openvpn",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Layer4openvpn
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySetLayer4Openvpn(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyLayer4OpenvpnToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle caddy layer4-openvpn",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyToggleLayer4Openvpn(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// caddyReverseProxyColumns defines table columns for the ReverseProxy resource.
var caddyReverseProxyColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Reverse); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Reverse); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "FROMDOMAIN", Extract: func(row any) string {
		if v, ok := row.(sdk.Reverse); ok {
			return fmt.Sprint(v.FromDomain)
		}
		return ""
	}},
	{Header: "FROMPORT", Extract: func(row any) string {
		if v, ok := row.(sdk.Reverse); ok {
			return fmt.Sprint(v.FromPort)
		}
		return ""
	}},
	{Header: "ACCESSLIST", Extract: func(row any) string {
		if v, ok := row.(sdk.Reverse); ok {
			return fmt.Sprint(v.Accesslist)
		}
		return ""
	}},
	{Header: "BASICAUTH", Extract: func(row any) string {
		if v, ok := row.(sdk.Reverse); ok {
			return fmt.Sprint(v.Basicauth)
		}
		return ""
	}},
	{Header: "DNSCHALLENGE", Extract: func(row any) string {
		if v, ok := row.(sdk.Reverse); ok {
			return fmt.Sprint(v.DnsChallenge)
		}
		return ""
	}},
	{Header: "DNSCHALLENGEOVERRIDEDOMAIN", Extract: func(row any) string {
		if v, ok := row.(sdk.Reverse); ok {
			return fmt.Sprint(v.DnsChallengeOverrideDomain)
		}
		return ""
	}},
}

func newCaddyReverseProxyCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "reverse-proxy",
		Short: "Manage caddy reverse-proxy resources",
	}
	cmd.AddCommand(newCaddyReverseProxyCreateCmd())
	cmd.AddCommand(newCaddyReverseProxyDeleteCmd())
	cmd.AddCommand(newCaddyReverseProxyGetCmd())
	cmd.AddCommand(newCaddyReverseProxyListCmd())
	cmd.AddCommand(newCaddyReverseProxySetCmd())
	cmd.AddCommand(newCaddyReverseProxyUpdateCmd())
	cmd.AddCommand(newCaddyReverseProxyToggleCmd())
	return cmd
}

func newCaddyReverseProxyCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create caddy reverse-proxy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Reverse
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyAddReverseProxy(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyReverseProxyDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete caddy reverse-proxy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyDelReverseProxy(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyReverseProxyGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy reverse-proxy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetReverseProxy(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyReverseProxyListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List caddy reverse-proxy resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ReverseProxySearchReverseProxy(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, caddyReverseProxyColumns)
		},
	}
}

func newCaddyReverseProxySetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set caddy reverse-proxy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyReverseProxyUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update caddy reverse-proxy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Reverse
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySetReverseProxy(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddyReverseProxyToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle caddy reverse-proxy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyToggleReverseProxy(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// caddySubdomainColumns defines table columns for the Subdomain resource.
var caddySubdomainColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Subdomain); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Subdomain); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "REVERSE", Extract: func(row any) string {
		if v, ok := row.(sdk.Subdomain); ok {
			return fmt.Sprint(v.Reverse)
		}
		return ""
	}},
	{Header: "FROMDOMAIN", Extract: func(row any) string {
		if v, ok := row.(sdk.Subdomain); ok {
			return fmt.Sprint(v.FromDomain)
		}
		return ""
	}},
	{Header: "ACCESSLIST", Extract: func(row any) string {
		if v, ok := row.(sdk.Subdomain); ok {
			return fmt.Sprint(v.Accesslist)
		}
		return ""
	}},
	{Header: "BASICAUTH", Extract: func(row any) string {
		if v, ok := row.(sdk.Subdomain); ok {
			return fmt.Sprint(v.Basicauth)
		}
		return ""
	}},
	{Header: "DYNDNS", Extract: func(row any) string {
		if v, ok := row.(sdk.Subdomain); ok {
			return fmt.Sprint(v.DynDns)
		}
		return ""
	}},
	{Header: "ACMEPASSTHROUGH", Extract: func(row any) string {
		if v, ok := row.(sdk.Subdomain); ok {
			return fmt.Sprint(v.AcmePassthrough)
		}
		return ""
	}},
}

func newCaddySubdomainCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "subdomain",
		Short: "Manage caddy subdomain resources",
	}
	cmd.AddCommand(newCaddySubdomainCreateCmd())
	cmd.AddCommand(newCaddySubdomainDeleteCmd())
	cmd.AddCommand(newCaddySubdomainGetCmd())
	cmd.AddCommand(newCaddySubdomainListCmd())
	cmd.AddCommand(newCaddySubdomainUpdateCmd())
	cmd.AddCommand(newCaddySubdomainToggleCmd())
	return cmd
}

func newCaddySubdomainCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create caddy subdomain",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Subdomain
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyAddSubdomain(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddySubdomainDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete caddy subdomain",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyDelSubdomain(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddySubdomainGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get caddy subdomain",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetSubdomain(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddySubdomainListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List caddy subdomain resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ReverseProxySearchSubdomain(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, caddySubdomainColumns)
		},
	}
}

func newCaddySubdomainUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update caddy subdomain",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Subdomain
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxySetSubdomain(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCaddySubdomainToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle caddy subdomain",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyToggleSubdomain(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCaddyAllReverseDomainsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "all-reverse-domains",
		Short: "Manage caddy all-reverse-domains resources",
	}
	cmd.AddCommand(newCaddyAllReverseDomainsGetAllReverseDomainsCmd())
	return cmd
}

func newCaddyAllReverseDomainsGetAllReverseDomainsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-all-reverse-domains",
		Short: "GetAllReverseDomains caddy all-reverse-domains",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ReverseProxyGetAllReverseDomains(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage caddy service resources",
	}
	cmd.AddCommand(newCaddyServiceReconfigureCmd())
	cmd.AddCommand(newCaddyServiceRestartCmd())
	cmd.AddCommand(newCaddyServiceStartCmd())
	cmd.AddCommand(newCaddyServiceStatusCmd())
	cmd.AddCommand(newCaddyServiceStopCmd())
	cmd.AddCommand(newCaddyServiceValidateCmd())
	return cmd
}

func newCaddyServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure caddy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart caddy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start caddy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyServiceStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status caddy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop caddy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCaddyServiceValidateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "validate",
		Short: "Validate caddy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceValidate(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

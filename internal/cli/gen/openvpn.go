// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/openvpn"
	"github.com/spf13/cobra"
)

func init() {
	registerOpenvpn()
}

func registerOpenvpn() {
	moduleCmd := &cobra.Command{
		Use:   "openvpn",
		Short: "Manage openvpn resources",
	}
	moduleCmd.AddCommand(newOpenvpnClientOverwritesCmd())
	moduleCmd.AddCommand(newOpenvpnExportCmd())
	moduleCmd.AddCommand(newOpenvpnInstancesCmd())
	moduleCmd.AddCommand(newOpenvpnStaticKeyCmd())
	moduleCmd.AddCommand(newOpenvpnServiceCmd())
	moduleCmd.AddCommand(newOpenvpnRoutesCmd())
	moduleCmd.AddCommand(newOpenvpnSessionsCmd())
	cli.Root.AddCommand(moduleCmd)
}

func newOpenvpnClientOverwritesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "client-overwrites",
		Short: "Manage openvpn client-overwrites resources",
	}
	cmd.AddCommand(newOpenvpnClientOverwritesAddCmd())
	cmd.AddCommand(newOpenvpnClientOverwritesDelCmd())
	cmd.AddCommand(newOpenvpnClientOverwritesGetCmd())
	cmd.AddCommand(newOpenvpnClientOverwritesSearchCmd())
	cmd.AddCommand(newOpenvpnClientOverwritesSetCmd())
	cmd.AddCommand(newOpenvpnClientOverwritesToggleCmd())
	return cmd
}

func newOpenvpnClientOverwritesAddCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "add",
		Short: "Add openvpn client-overwrites",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ClientOverwritesAdd(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnClientOverwritesDelCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del <uuid>",
		Short: "Del openvpn client-overwrites",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ClientOverwritesDel(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnClientOverwritesGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get openvpn client-overwrites",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ClientOverwritesGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnClientOverwritesSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search openvpn client-overwrites",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ClientOverwritesSearch(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnClientOverwritesSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set openvpn client-overwrites",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ClientOverwritesSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnClientOverwritesToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle openvpn client-overwrites",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ClientOverwritesToggle(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnExportCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "export",
		Short: "Manage openvpn export resources",
	}
	cmd.AddCommand(newOpenvpnExportAccountsCmd())
	cmd.AddCommand(newOpenvpnExportDownloadCmd())
	cmd.AddCommand(newOpenvpnExportProvidersCmd())
	cmd.AddCommand(newOpenvpnExportStorePresetsCmd())
	cmd.AddCommand(newOpenvpnExportTemplatesCmd())
	cmd.AddCommand(newOpenvpnExportValidatePresetsCmd())
	return cmd
}

func newOpenvpnExportAccountsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "accounts",
		Short: "Accounts openvpn export",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ExportAccounts(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnExportDownloadCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "download <vpnid>",
		Short: "Download openvpn export",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ExportDownload(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnExportProvidersCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "providers",
		Short: "Providers openvpn export",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ExportProviders(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnExportStorePresetsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "store-presets <vpnid>",
		Short: "StorePresets openvpn export",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ExportStorePresets(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnExportTemplatesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "templates",
		Short: "Templates openvpn export",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ExportTemplates(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnExportValidatePresetsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "validate-presets <vpnid>",
		Short: "ValidatePresets openvpn export",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ExportValidatePresets(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnInstancesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "instances",
		Short: "Manage openvpn instances resources",
	}
	cmd.AddCommand(newOpenvpnInstancesAddCmd())
	cmd.AddCommand(newOpenvpnInstancesDelCmd())
	cmd.AddCommand(newOpenvpnInstancesGenKeyCmd())
	cmd.AddCommand(newOpenvpnInstancesGetCmd())
	cmd.AddCommand(newOpenvpnInstancesSearchCmd())
	cmd.AddCommand(newOpenvpnInstancesSetCmd())
	cmd.AddCommand(newOpenvpnInstancesToggleCmd())
	return cmd
}

func newOpenvpnInstancesAddCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "add",
		Short: "Add openvpn instances",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesAdd(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnInstancesDelCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del <uuid>",
		Short: "Del openvpn instances",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesDel(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnInstancesGenKeyCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "gen-key",
		Short: "GenKey openvpn instances",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesGenKey(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnInstancesGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get openvpn instances",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnInstancesSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search openvpn instances",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesSearch(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnInstancesSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set openvpn instances",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnInstancesToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle openvpn instances",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesToggle(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// openvpnStaticKeyColumns defines table columns for the StaticKey resource.
var openvpnStaticKeyColumns = []cli.Column{
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.StaticKey); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "MODE", Extract: func(row any) string {
		if v, ok := row.(sdk.StaticKey); ok {
			return fmt.Sprint(v.Mode)
		}
		return ""
	}},
	{Header: "KEY", Extract: func(row any) string {
		if v, ok := row.(sdk.StaticKey); ok {
			return fmt.Sprint(v.Key)
		}
		return ""
	}},
}

func newOpenvpnStaticKeyCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "static-key",
		Short: "Manage openvpn static-key resources",
	}
	cmd.AddCommand(newOpenvpnStaticKeyCreateCmd())
	cmd.AddCommand(newOpenvpnStaticKeyDeleteCmd())
	cmd.AddCommand(newOpenvpnStaticKeyGetCmd())
	cmd.AddCommand(newOpenvpnStaticKeyListCmd())
	cmd.AddCommand(newOpenvpnStaticKeyUpdateCmd())
	return cmd
}

func newOpenvpnStaticKeyCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create openvpn static-key",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.StaticKey
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesAddStaticKey(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newOpenvpnStaticKeyDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete openvpn static-key",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesDelStaticKey(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newOpenvpnStaticKeyGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get openvpn static-key",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesGetStaticKey(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newOpenvpnStaticKeyListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List openvpn static-key resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.InstancesSearchStaticKey(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, openvpnStaticKeyColumns)
		},
	}
}

func newOpenvpnStaticKeyUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update",
		Short: "Update openvpn static-key",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.StaticKey
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.InstancesSetStaticKey(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newOpenvpnServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage openvpn service resources",
	}
	cmd.AddCommand(newOpenvpnServiceKillSessionCmd())
	cmd.AddCommand(newOpenvpnServiceReconfigureCmd())
	cmd.AddCommand(newOpenvpnServiceRestartServiceCmd())
	cmd.AddCommand(newOpenvpnServiceStartServiceCmd())
	cmd.AddCommand(newOpenvpnServiceStopServiceCmd())
	return cmd
}

func newOpenvpnServiceKillSessionCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "kill-session",
		Short: "KillSession openvpn service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceKillSession(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure openvpn service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnServiceRestartServiceCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart-service",
		Short: "RestartService openvpn service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestartService(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnServiceStartServiceCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start-service",
		Short: "StartService openvpn service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStartService(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnServiceStopServiceCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop-service",
		Short: "StopService openvpn service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStopService(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnRoutesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "routes",
		Short: "Manage openvpn routes resources",
	}
	cmd.AddCommand(newOpenvpnRoutesSearchRoutesCmd())
	return cmd
}

func newOpenvpnRoutesSearchRoutesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search-routes",
		Short: "SearchRoutes openvpn routes",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceSearchRoutes(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newOpenvpnSessionsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "sessions",
		Short: "Manage openvpn sessions resources",
	}
	cmd.AddCommand(newOpenvpnSessionsSearchSessionsCmd())
	return cmd
}

func newOpenvpnSessionsSearchSessionsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search-sessions",
		Short: "SearchSessions openvpn sessions",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceSearchSessions(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

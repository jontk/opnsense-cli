// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/core"
	"github.com/spf13/cobra"
)

func init() {
	registerCore()
}

func registerCore() {
	moduleCmd := &cobra.Command{
		Use:   "core",
		Short: "Manage core resources",
	}
	moduleCmd.AddCommand(newCoreBackupCmd())
	moduleCmd.AddCommand(newCoreDashboardCmd())
	moduleCmd.AddCommand(newCoreDefaultsCmd())
	moduleCmd.AddCommand(newCoreInstalledSectionsCmd())
	moduleCmd.AddCommand(newCoreHasyncCmd())
	moduleCmd.AddCommand(newCoreHasyncStatusCmd())
	moduleCmd.AddCommand(newCoreInitialSetupCmd())
	moduleCmd.AddCommand(newCoreMenuCmd())
	moduleCmd.AddCommand(newCoreServiceCmd())
	moduleCmd.AddCommand(newCoreSnapshotsCmd())
	moduleCmd.AddCommand(newCoreSystemCmd())
	moduleCmd.AddCommand(newCoreTunablesCmd())
	cli.Root.AddCommand(moduleCmd)
}

func newCoreBackupCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "backup",
		Short: "Manage core backup resources",
	}
	cmd.AddCommand(newCoreBackupBackupsCmd())
	cmd.AddCommand(newCoreBackupDeleteBackupCmd())
	cmd.AddCommand(newCoreBackupDiffCmd())
	cmd.AddCommand(newCoreBackupDownloadCmd())
	cmd.AddCommand(newCoreBackupProvidersCmd())
	cmd.AddCommand(newCoreBackupRevertBackupCmd())
	return cmd
}

func newCoreBackupBackupsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "backups <host>",
		Short: "Backups core backup",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.BackupBackups(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreBackupDeleteBackupCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete-backup <backup>",
		Short: "DeleteBackup core backup",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.BackupDeleteBackup(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreBackupDiffCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "diff <host> <backup1> <backup2>",
		Short: "Diff core backup",
		Args:  cobra.ExactArgs(3),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.BackupDiff(context.Background(), args[0], args[1], args[2])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreBackupDownloadCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "download <host>",
		Short: "Download core backup",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.BackupDownload(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreBackupProvidersCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "providers",
		Short: "Providers core backup",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.BackupProviders(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreBackupRevertBackupCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "revert-backup <backup>",
		Short: "RevertBackup core backup",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.BackupRevertBackup(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreDashboardCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "dashboard",
		Short: "Manage core dashboard resources",
	}
	cmd.AddCommand(newCoreDashboardGetDashboardCmd())
	cmd.AddCommand(newCoreDashboardPictureCmd())
	cmd.AddCommand(newCoreDashboardProductInfoFeedCmd())
	cmd.AddCommand(newCoreDashboardRestoreDefaultsCmd())
	cmd.AddCommand(newCoreDashboardSaveWidgetsCmd())
	return cmd
}

func newCoreDashboardGetDashboardCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-dashboard",
		Short: "GetDashboard core dashboard",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DashboardGetDashboard(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreDashboardPictureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "picture",
		Short: "Picture core dashboard",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DashboardPicture(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreDashboardProductInfoFeedCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "product-info-feed",
		Short: "ProductInfoFeed core dashboard",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DashboardProductInfoFeed(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreDashboardRestoreDefaultsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restore-defaults",
		Short: "RestoreDefaults core dashboard",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DashboardRestoreDefaults(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreDashboardSaveWidgetsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "save-widgets",
		Short: "SaveWidgets core dashboard",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DashboardSaveWidgets(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreDefaultsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "defaults",
		Short: "Manage core defaults resources",
	}
	cmd.AddCommand(newCoreDefaultsFactoryDefaultsCmd())
	cmd.AddCommand(newCoreDefaultsGetCmd())
	cmd.AddCommand(newCoreDefaultsResetCmd())
	return cmd
}

func newCoreDefaultsFactoryDefaultsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "factory-defaults",
		Short: "FactoryDefaults core defaults",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DefaultsFactoryDefaults(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreDefaultsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get core defaults",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DefaultsGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreDefaultsResetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reset",
		Short: "Reset core defaults",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DefaultsReset(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreInstalledSectionsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "installed-sections",
		Short: "Manage core installed-sections resources",
	}
	cmd.AddCommand(newCoreInstalledSectionsGetInstalledSectionsCmd())
	return cmd
}

func newCoreInstalledSectionsGetInstalledSectionsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get-installed-sections",
		Short: "GetInstalledSections core installed-sections",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DefaultsGetInstalledSections(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "hasync",
		Short: "Manage core hasync resources",
	}
	cmd.AddCommand(newCoreHasyncGetCmd())
	cmd.AddCommand(newCoreHasyncReconfigureCmd())
	cmd.AddCommand(newCoreHasyncSetCmd())
	return cmd
}

func newCoreHasyncGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get core hasync",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure core hasync",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set core hasync",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncStatusCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "hasync-status",
		Short: "Manage core hasync-status resources",
	}
	cmd.AddCommand(newCoreHasyncStatusRemoteServiceCmd())
	cmd.AddCommand(newCoreHasyncStatusRestartCmd())
	cmd.AddCommand(newCoreHasyncStatusRestartAllCmd())
	cmd.AddCommand(newCoreHasyncStatusServicesCmd())
	cmd.AddCommand(newCoreHasyncStatusStartCmd())
	cmd.AddCommand(newCoreHasyncStatusStopCmd())
	cmd.AddCommand(newCoreHasyncStatusVersionCmd())
	return cmd
}

func newCoreHasyncStatusRemoteServiceCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "remote-service <action> <service> <service_id>",
		Short: "RemoteService core hasync-status",
		Args:  cobra.ExactArgs(3),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncStatusRemoteService(context.Background(), args[0], args[1], args[2])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncStatusRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart core hasync-status",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncStatusRestart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncStatusRestartAllCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart-all",
		Short: "RestartAll core hasync-status",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncStatusRestartAll(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncStatusServicesCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "services",
		Short: "Services core hasync-status",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncStatusServices(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncStatusStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start core hasync-status",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncStatusStart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncStatusStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop core hasync-status",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncStatusStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreHasyncStatusVersionCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "version",
		Short: "Version core hasync-status",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.HasyncStatusVersion(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreInitialSetupCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "initial-setup",
		Short: "Manage core initial-setup resources",
	}
	cmd.AddCommand(newCoreInitialSetupAbortCmd())
	cmd.AddCommand(newCoreInitialSetupConfigureCmd())
	cmd.AddCommand(newCoreInitialSetupGetCmd())
	cmd.AddCommand(newCoreInitialSetupSetCmd())
	return cmd
}

func newCoreInitialSetupAbortCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "abort",
		Short: "Abort core initial-setup",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InitialSetupAbort(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreInitialSetupConfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "configure",
		Short: "Configure core initial-setup",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InitialSetupConfigure(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreInitialSetupGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get core initial-setup",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InitialSetupGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreInitialSetupSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set core initial-setup",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.InitialSetupSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreMenuCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "menu",
		Short: "Manage core menu resources",
	}
	cmd.AddCommand(newCoreMenuSearchCmd())
	cmd.AddCommand(newCoreMenuTreeCmd())
	return cmd
}

func newCoreMenuSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search core menu",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.MenuSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreMenuTreeCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "tree",
		Short: "Tree core menu",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.MenuTree(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage core service resources",
	}
	cmd.AddCommand(newCoreServiceRestartCmd())
	cmd.AddCommand(newCoreServiceSearchCmd())
	cmd.AddCommand(newCoreServiceStartCmd())
	cmd.AddCommand(newCoreServiceStopCmd())
	return cmd
}

func newCoreServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart <name>",
		Short: "Restart core service",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreServiceSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search core service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start <name>",
		Short: "Start core service",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop <name>",
		Short: "Stop core service",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSnapshotsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "snapshots",
		Short: "Manage core snapshots resources",
	}
	cmd.AddCommand(newCoreSnapshotsActivateCmd())
	cmd.AddCommand(newCoreSnapshotsAddCmd())
	cmd.AddCommand(newCoreSnapshotsDelCmd())
	cmd.AddCommand(newCoreSnapshotsGetCmd())
	cmd.AddCommand(newCoreSnapshotsIsSupportedCmd())
	cmd.AddCommand(newCoreSnapshotsSearchCmd())
	cmd.AddCommand(newCoreSnapshotsSetCmd())
	return cmd
}

func newCoreSnapshotsActivateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "activate <uuid>",
		Short: "Activate core snapshots",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SnapshotsActivate(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSnapshotsAddCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "add",
		Short: "Add core snapshots",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SnapshotsAdd(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSnapshotsDelCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del <uuid>",
		Short: "Del core snapshots",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SnapshotsDel(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSnapshotsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get core snapshots",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SnapshotsGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSnapshotsIsSupportedCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "is-supported",
		Short: "IsSupported core snapshots",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SnapshotsIsSupported(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSnapshotsSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search core snapshots",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SnapshotsSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSnapshotsSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set <uuid>",
		Short: "Set core snapshots",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SnapshotsSet(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSystemCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "system",
		Short: "Manage core system resources",
	}
	cmd.AddCommand(newCoreSystemDismissStatusCmd())
	cmd.AddCommand(newCoreSystemHaltCmd())
	cmd.AddCommand(newCoreSystemRebootCmd())
	cmd.AddCommand(newCoreSystemStatusCmd())
	return cmd
}

func newCoreSystemDismissStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "dismiss-status",
		Short: "DismissStatus core system",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SystemDismissStatus(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSystemHaltCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "halt",
		Short: "Halt core system",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SystemHalt(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSystemRebootCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reboot",
		Short: "Reboot core system",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SystemReboot(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreSystemStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status core system",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SystemStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// coreTunablesColumns defines table columns for the Tunables resource.
var coreTunablesColumns = []cli.Column{
	{Header: "TYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Item); ok {
			return fmt.Sprint(v.Type)
		}
		return ""
	}},
	{Header: "TUNABLE", Extract: func(row any) string {
		if v, ok := row.(sdk.Item); ok {
			return fmt.Sprint(v.Tunable)
		}
		return ""
	}},
	{Header: "VALUE", Extract: func(row any) string {
		if v, ok := row.(sdk.Item); ok {
			return fmt.Sprint(v.Value)
		}
		return ""
	}},
	{Header: "DESCR", Extract: func(row any) string {
		if v, ok := row.(sdk.Item); ok {
			return fmt.Sprint(v.Descr)
		}
		return ""
	}},
	{Header: "DEFAULT VALUE", Extract: func(row any) string {
		if v, ok := row.(sdk.Item); ok {
			return fmt.Sprint(v.DefaultValue)
		}
		return ""
	}},
}

func newCoreTunablesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "tunables",
		Short: "Manage core tunables resources",
	}
	cmd.AddCommand(newCoreTunablesCreateCmd())
	cmd.AddCommand(newCoreTunablesDeleteCmd())
	cmd.AddCommand(newCoreTunablesGetCmd())
	cmd.AddCommand(newCoreTunablesReconfigureCmd())
	cmd.AddCommand(newCoreTunablesResetCmd())
	cmd.AddCommand(newCoreTunablesListCmd())
	cmd.AddCommand(newCoreTunablesSetCmd())
	cmd.AddCommand(newCoreTunablesUpdateCmd())
	return cmd
}

func newCoreTunablesCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create core tunables",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Item
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.TunablesAddItem(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newCoreTunablesDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete core tunables",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunablesDelItem(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCoreTunablesGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get core tunables",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunablesGetItem(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newCoreTunablesReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure core tunables",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunablesReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreTunablesResetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reset",
		Short: "Reset core tunables",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunablesReset(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreTunablesListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List core tunables resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.TunablesSearchItem(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, coreTunablesColumns)
		},
	}
}

func newCoreTunablesSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set core tunables",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TunablesSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCoreTunablesUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update core tunables",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Item
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.TunablesSetItem(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

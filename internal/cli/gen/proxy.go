// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/proxy"
	"github.com/spf13/cobra"
)

func init() {
	registerProxy()
}

func registerProxy() {
	moduleCmd := &cobra.Command{
		Use:   "proxy",
		Short: "Manage proxy resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			if len(args) == 0 {
				return cmd.Help()
			}
			msg := fmt.Sprintf("unknown command %q for %q", args[0], cmd.CommandPath())
			if sugg := cmd.SuggestionsFor(args[0]); len(sugg) > 0 {
				msg += "\n\nDid you mean this?"
				for _, s := range sugg {
					msg += "\n\t" + s
				}
			}
			return fmt.Errorf("%s\n\nRun '%s --help' for usage.", msg, cmd.CommandPath())
		},
	}
	moduleCmd.AddCommand(newProxyServiceCmd())
	moduleCmd.AddCommand(newProxyPacRuleCmd())
	moduleCmd.AddCommand(newProxyPacMatchCmd())
	moduleCmd.AddCommand(newProxyPacProxyCmd())
	moduleCmd.AddCommand(newProxyRemoteBlacklistCmd())
	moduleCmd.AddCommand(newProxySettingsCmd())
	moduleCmd.AddCommand(newProxyTemplateCmd())
	moduleCmd.AddCommand(newProxyCustomPolicyCmd())
	moduleCmd.AddCommand(newProxyPolicyCmd())
	moduleCmd.AddCommand(newProxyAclCmd())
	cli.Root.AddCommand(moduleCmd)
}

func newProxyServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage proxy service resources",
	}
	cmd.AddCommand(newProxyServiceDownloadaclsCmd())
	cmd.AddCommand(newProxyServiceFetchaclsCmd())
	cmd.AddCommand(newProxyServiceReconfigureCmd())
	cmd.AddCommand(newProxyServiceRefreshTemplateCmd())
	cmd.AddCommand(newProxyServiceResetCmd())
	cmd.AddCommand(newProxyServiceRestartCmd())
	cmd.AddCommand(newProxyServiceStartCmd())
	cmd.AddCommand(newProxyServiceStatusCmd())
	cmd.AddCommand(newProxyServiceStopCmd())
	return cmd
}

func newProxyServiceDownloadaclsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "downloadacls",
		Short: "Downloadacls proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceDownloadacls(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyServiceFetchaclsCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "fetchacls",
		Short: "Fetchacls proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceFetchacls(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyServiceRefreshTemplateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "refresh-template",
		Short: "RefreshTemplate proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRefreshTemplate(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyServiceResetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reset",
		Short: "Reset proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReset(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyServiceStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop proxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// proxyPacRuleColumns defines table columns for the PacRule resource.
var proxyPacRuleColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "MATCHES", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Matches)
		}
		return ""
	}},
	{Header: "JOIN TYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.JoinType)
		}
		return ""
	}},
	{Header: "MATCH TYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.MatchType)
		}
		return ""
	}},
	{Header: "PROXIES", Extract: func(row any) string {
		if v, ok := row.(sdk.Rule); ok {
			return fmt.Sprint(v.Proxies)
		}
		return ""
	}},
}

func newProxyPacRuleCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "pac-rule",
		Short: "Manage proxy pac-rule resources",
	}
	cmd.AddCommand(newProxyPacRuleCreateCmd())
	cmd.AddCommand(newProxyPacRuleDeleteCmd())
	cmd.AddCommand(newProxyPacRuleGetCmd())
	cmd.AddCommand(newProxyPacRuleListCmd())
	cmd.AddCommand(newProxyPacRuleUpdateCmd())
	cmd.AddCommand(newProxyPacRuleToggleCmd())
	return cmd
}

func newProxyPacRuleCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create proxy pac-rule",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Rule
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddPACRule(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newProxyPacRuleDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete proxy pac-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelPacRule(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newProxyPacRuleGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy pac-rule",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetPacRule(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newProxyPacRuleListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List proxy pac-rule resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchPacRule(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, proxyPacRuleColumns)
		},
	}
}

func newProxyPacRuleUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update proxy pac-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Rule
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetPacRule(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newProxyPacRuleToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle proxy pac-rule",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsTogglePacRule(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

// proxyPacMatchColumns defines table columns for the PacMatch resource.
var proxyPacMatchColumns = []cli.Column{
	{Header: "NAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Match); ok {
			return fmt.Sprint(v.Name)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Match); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "NEGATE", Extract: func(row any) string {
		if v, ok := row.(sdk.Match); ok {
			return fmt.Sprint(v.Negate)
		}
		return ""
	}},
	{Header: "MATCH TYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Match); ok {
			return fmt.Sprint(v.MatchType)
		}
		return ""
	}},
	{Header: "HOSTNAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Match); ok {
			return fmt.Sprint(v.Hostname)
		}
		return ""
	}},
	{Header: "URL", Extract: func(row any) string {
		if v, ok := row.(sdk.Match); ok {
			return fmt.Sprint(v.Url)
		}
		return ""
	}},
	{Header: "NETWORK", Extract: func(row any) string {
		if v, ok := row.(sdk.Match); ok {
			return fmt.Sprint(v.Network)
		}
		return ""
	}},
	{Header: "DOMAIN LEVEL FROM", Extract: func(row any) string {
		if v, ok := row.(sdk.Match); ok {
			if v.DomainLevelFrom != nil {
				return fmt.Sprint(*v.DomainLevelFrom)
			}
			return ""
		}
		return ""
	}},
}

func newProxyPacMatchCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "pac-match",
		Short: "Manage proxy pac-match resources",
	}
	cmd.AddCommand(newProxyPacMatchCreateCmd())
	cmd.AddCommand(newProxyPacMatchDeleteCmd())
	cmd.AddCommand(newProxyPacMatchGetCmd())
	cmd.AddCommand(newProxyPacMatchListCmd())
	cmd.AddCommand(newProxyPacMatchUpdateCmd())
	return cmd
}

func newProxyPacMatchCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create proxy pac-match",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Match
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddPacMatch(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newProxyPacMatchDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete proxy pac-match",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelPacMatch(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newProxyPacMatchGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy pac-match",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetPacMatch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newProxyPacMatchListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List proxy pac-match resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchPacMatch(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, proxyPacMatchColumns)
		},
	}
}

func newProxyPacMatchUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update proxy pac-match",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Match
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetPacMatch(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

// proxyPacProxyColumns defines table columns for the PacProxy resource.
var proxyPacProxyColumns = []cli.Column{
	{Header: "NAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Proxy); ok {
			return fmt.Sprint(v.Name)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Proxy); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
	{Header: "PROXY TYPE", Extract: func(row any) string {
		if v, ok := row.(sdk.Proxy); ok {
			return fmt.Sprint(v.ProxyType)
		}
		return ""
	}},
	{Header: "URL", Extract: func(row any) string {
		if v, ok := row.(sdk.Proxy); ok {
			return fmt.Sprint(v.Url)
		}
		return ""
	}},
}

func newProxyPacProxyCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "pac-proxy",
		Short: "Manage proxy pac-proxy resources",
	}
	cmd.AddCommand(newProxyPacProxyCreateCmd())
	cmd.AddCommand(newProxyPacProxyDeleteCmd())
	cmd.AddCommand(newProxyPacProxyGetCmd())
	cmd.AddCommand(newProxyPacProxyListCmd())
	cmd.AddCommand(newProxyPacProxyUpdateCmd())
	return cmd
}

func newProxyPacProxyCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create proxy pac-proxy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Proxy
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddPacProxy(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newProxyPacProxyDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete proxy pac-proxy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelPacProxy(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newProxyPacProxyGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy pac-proxy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetPacProxy(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newProxyPacProxyListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List proxy pac-proxy resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.SettingsSearchPacProxy(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, proxyPacProxyColumns)
		},
	}
}

func newProxyPacProxyUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update proxy pac-proxy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Proxy
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetPacProxy(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newProxyRemoteBlacklistCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "remote-blacklist",
		Short: "Manage proxy remote-blacklist resources",
	}
	cmd.AddCommand(newProxyRemoteBlacklistCreateCmd())
	cmd.AddCommand(newProxyRemoteBlacklistDeleteCmd())
	cmd.AddCommand(newProxyRemoteBlacklistGetCmd())
	cmd.AddCommand(newProxyRemoteBlacklistUpdateCmd())
	cmd.AddCommand(newProxyRemoteBlacklistToggleCmd())
	cmd.AddCommand(newProxyRemoteBlacklistListCmd())
	return cmd
}

func newProxyRemoteBlacklistCreateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "create",
		Short: "Create proxy remote-blacklist",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsAddRemoteBlacklist(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyRemoteBlacklistDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete proxy remote-blacklist",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsDelRemoteBlacklist(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyRemoteBlacklistGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy remote-blacklist",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGetRemoteBlacklist(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyRemoteBlacklistUpdateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update proxy remote-blacklist",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSetRemoteBlacklist(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyRemoteBlacklistToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle proxy remote-blacklist",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsToggleRemoteBlacklist(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyRemoteBlacklistListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List proxy remote-blacklist",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSearchRemoteBlacklists(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxySettingsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "settings",
		Short: "Manage proxy settings resources",
	}
	cmd.AddCommand(newProxySettingsFetchRbCronCmd())
	cmd.AddCommand(newProxySettingsGetCmd())
	cmd.AddCommand(newProxySettingsSetCmd())
	return cmd
}

func newProxySettingsFetchRbCronCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "fetch-rb-cron",
		Short: "FetchRbCron proxy settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsFetchRbCron(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxySettingsGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxySettingsSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set proxy settings",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.SettingsSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyTemplateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "template",
		Short: "Manage proxy template resources",
	}
	cmd.AddCommand(newProxyTemplateGetCmd())
	cmd.AddCommand(newProxyTemplateResetCmd())
	cmd.AddCommand(newProxyTemplateSetCmd())
	return cmd
}

func newProxyTemplateGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy template",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TemplateGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyTemplateResetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reset",
		Short: "Reset proxy template",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TemplateReset(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyTemplateSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set proxy template",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.TemplateSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyCustomPolicyCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "custom-policy",
		Short: "Manage proxy custom-policy resources",
	}
	cmd.AddCommand(newProxyCustomPolicyCreateCmd())
	cmd.AddCommand(newProxyCustomPolicyDeleteCmd())
	cmd.AddCommand(newProxyCustomPolicyGetCmd())
	cmd.AddCommand(newProxyCustomPolicyListCmd())
	cmd.AddCommand(newProxyCustomPolicyUpdateCmd())
	cmd.AddCommand(newProxyCustomPolicyToggleCmd())
	return cmd
}

func newProxyCustomPolicyCreateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "create",
		Short: "Create proxy custom-policy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclAddCustomPolicy(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyCustomPolicyDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete proxy custom-policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclDelCustomPolicy(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyCustomPolicyGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy custom-policy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclGetCustomPolicy(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyCustomPolicyListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List proxy custom-policy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclSearchCustomPolicy(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyCustomPolicyUpdateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update proxy custom-policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclSetCustomPolicy(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyCustomPolicyToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle proxy custom-policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclToggleCustomPolicy(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyPolicyCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "policy",
		Short: "Manage proxy policy resources",
	}
	cmd.AddCommand(newProxyPolicyCreateCmd())
	cmd.AddCommand(newProxyPolicyDeleteCmd())
	cmd.AddCommand(newProxyPolicyGetCmd())
	cmd.AddCommand(newProxyPolicyListCmd())
	cmd.AddCommand(newProxyPolicyUpdateCmd())
	cmd.AddCommand(newProxyPolicyToggleCmd())
	return cmd
}

func newProxyPolicyCreateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "create",
		Short: "Create proxy policy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclAddPolicy(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyPolicyDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete proxy policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclDelPolicy(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyPolicyGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy policy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclGetPolicy(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyPolicyListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List proxy policy",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclSearchPolicy(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyPolicyUpdateCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update proxy policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclSetPolicy(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyPolicyToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle proxy policy",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclTogglePolicy(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyAclCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "acl",
		Short: "Manage proxy acl resources",
	}
	cmd.AddCommand(newProxyAclApplyCmd())
	cmd.AddCommand(newProxyAclGetCmd())
	cmd.AddCommand(newProxyAclSetCmd())
	cmd.AddCommand(newProxyAclTestCmd())
	return cmd
}

func newProxyAclApplyCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "apply",
		Short: "Apply proxy acl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclApply(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyAclGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get proxy acl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyAclSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set proxy acl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newProxyAclTestCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "test",
		Short: "Test proxy acl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AclTest(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

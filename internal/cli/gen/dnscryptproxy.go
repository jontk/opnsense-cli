// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"encoding/json"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/dnscryptproxy"
	"github.com/spf13/cobra"
)

func init() {
	registerDnscryptproxy()
}

func registerDnscryptproxy() {
	moduleCmd := &cobra.Command{
		Use:   "dnscryptproxy",
		Short: "Manage dnscryptproxy resources",
	}
	moduleCmd.AddCommand(newDnscryptproxyCloakCmd())
	moduleCmd.AddCommand(newDnscryptproxyDnsblCmd())
	moduleCmd.AddCommand(newDnscryptproxyForwardCmd())
	moduleCmd.AddCommand(newDnscryptproxyGeneralCmd())
	moduleCmd.AddCommand(newDnscryptproxyServerCmd())
	moduleCmd.AddCommand(newDnscryptproxyServiceCmd())
	moduleCmd.AddCommand(newDnscryptproxyWhitelistCmd())
	cli.Root.AddCommand(moduleCmd)
}

// dnscryptproxyCloakColumns defines table columns for the Cloak resource.
var dnscryptproxyCloakColumns = []cli.Column{
	{Header: "NAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Cloak); ok {
			return fmt.Sprint(v.Name)
		}
		return ""
	}},
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Cloak); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESTINATION", Extract: func(row any) string {
		if v, ok := row.(sdk.Cloak); ok {
			return fmt.Sprint(v.Destination)
		}
		return ""
	}},
}

func newDnscryptproxyCloakCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "cloak",
		Short: "Manage dnscryptproxy cloak resources",
	}
	cmd.AddCommand(newDnscryptproxyCloakCreateCmd())
	cmd.AddCommand(newDnscryptproxyCloakDeleteCmd())
	cmd.AddCommand(newDnscryptproxyCloakGetCmd())
	cmd.AddCommand(newDnscryptproxyCloakListCmd())
	cmd.AddCommand(newDnscryptproxyCloakSetCmd())
	cmd.AddCommand(newDnscryptproxyCloakUpdateCmd())
	cmd.AddCommand(newDnscryptproxyCloakToggleCmd())
	return cmd
}

func newDnscryptproxyCloakCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create dnscryptproxy cloak",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Cloak
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.CloakAddCloak(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newDnscryptproxyCloakDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete dnscryptproxy cloak",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.CloakDelCloak(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyCloakGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get dnscryptproxy cloak",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.CloakGetCloak(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyCloakListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List dnscryptproxy cloak resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.CloakSearchCloak(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, dnscryptproxyCloakColumns)
		},
	}
}

func newDnscryptproxyCloakSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set dnscryptproxy cloak",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.CloakSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyCloakUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update dnscryptproxy cloak",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Cloak
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.CloakSetCloak(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newDnscryptproxyCloakToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle dnscryptproxy cloak",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.CloakToggleCloak(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyDnsblCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "dnsbl",
		Short: "Manage dnscryptproxy dnsbl resources",
	}
	cmd.AddCommand(newDnscryptproxyDnsblGetCmd())
	cmd.AddCommand(newDnscryptproxyDnsblSetCmd())
	return cmd
}

func newDnscryptproxyDnsblGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get dnscryptproxy dnsbl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DnsblGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyDnsblSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set dnscryptproxy dnsbl",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DnsblSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// dnscryptproxyForwardColumns defines table columns for the Forward resource.
var dnscryptproxyForwardColumns = []cli.Column{
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Forward); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DOMAIN", Extract: func(row any) string {
		if v, ok := row.(sdk.Forward); ok {
			return fmt.Sprint(v.Domain)
		}
		return ""
	}},
	{Header: "DNSSERVER", Extract: func(row any) string {
		if v, ok := row.(sdk.Forward); ok {
			return fmt.Sprint(v.Dnsserver)
		}
		return ""
	}},
}

func newDnscryptproxyForwardCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "forward",
		Short: "Manage dnscryptproxy forward resources",
	}
	cmd.AddCommand(newDnscryptproxyForwardCreateCmd())
	cmd.AddCommand(newDnscryptproxyForwardDeleteCmd())
	cmd.AddCommand(newDnscryptproxyForwardGetCmd())
	cmd.AddCommand(newDnscryptproxyForwardListCmd())
	cmd.AddCommand(newDnscryptproxyForwardSetCmd())
	cmd.AddCommand(newDnscryptproxyForwardUpdateCmd())
	cmd.AddCommand(newDnscryptproxyForwardToggleCmd())
	return cmd
}

func newDnscryptproxyForwardCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create dnscryptproxy forward",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Forward
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ForwardAddForward(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newDnscryptproxyForwardDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete dnscryptproxy forward",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ForwardDelForward(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyForwardGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get dnscryptproxy forward",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ForwardGetForward(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyForwardListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List dnscryptproxy forward resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ForwardSearchForward(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, dnscryptproxyForwardColumns)
		},
	}
}

func newDnscryptproxyForwardSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set dnscryptproxy forward",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ForwardSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyForwardUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update dnscryptproxy forward",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Forward
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ForwardSetForward(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newDnscryptproxyForwardToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle dnscryptproxy forward",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ForwardToggleForward(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyGeneralCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "general",
		Short: "Manage dnscryptproxy general resources",
	}
	cmd.AddCommand(newDnscryptproxyGeneralGetCmd())
	cmd.AddCommand(newDnscryptproxyGeneralSetCmd())
	return cmd
}

func newDnscryptproxyGeneralGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get dnscryptproxy general",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.GeneralGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyGeneralSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set dnscryptproxy general",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.GeneralSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// dnscryptproxyServerColumns defines table columns for the Server resource.
var dnscryptproxyServerColumns = []cli.Column{
	{Header: "NAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Server); ok {
			return fmt.Sprint(v.Name)
		}
		return ""
	}},
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Server); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "STAMP", Extract: func(row any) string {
		if v, ok := row.(sdk.Server); ok {
			return fmt.Sprint(v.Stamp)
		}
		return ""
	}},
}

func newDnscryptproxyServerCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "server",
		Short: "Manage dnscryptproxy server resources",
	}
	cmd.AddCommand(newDnscryptproxyServerCreateCmd())
	cmd.AddCommand(newDnscryptproxyServerDeleteCmd())
	cmd.AddCommand(newDnscryptproxyServerGetCmd())
	cmd.AddCommand(newDnscryptproxyServerListCmd())
	cmd.AddCommand(newDnscryptproxyServerSetCmd())
	cmd.AddCommand(newDnscryptproxyServerUpdateCmd())
	cmd.AddCommand(newDnscryptproxyServerToggleCmd())
	return cmd
}

func newDnscryptproxyServerCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create dnscryptproxy server",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Server
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ServerAddServer(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newDnscryptproxyServerDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete dnscryptproxy server",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServerDelServer(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyServerGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get dnscryptproxy server",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServerGetServer(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyServerListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List dnscryptproxy server resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.ServerSearchServer(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, dnscryptproxyServerColumns)
		},
	}
}

func newDnscryptproxyServerSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set dnscryptproxy server",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServerSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyServerUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update dnscryptproxy server",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Server
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.ServerSetServer(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newDnscryptproxyServerToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle dnscryptproxy server",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServerToggleServer(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage dnscryptproxy service resources",
	}
	cmd.AddCommand(newDnscryptproxyServiceDnsblCmd())
	cmd.AddCommand(newDnscryptproxyServiceReconfigureCmd())
	cmd.AddCommand(newDnscryptproxyServiceRestartCmd())
	cmd.AddCommand(newDnscryptproxyServiceStartCmd())
	cmd.AddCommand(newDnscryptproxyServiceStatusCmd())
	cmd.AddCommand(newDnscryptproxyServiceStopCmd())
	return cmd
}

func newDnscryptproxyServiceDnsblCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "dnsbl",
		Short: "Dnsbl dnscryptproxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceDnsbl(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure dnscryptproxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart dnscryptproxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start dnscryptproxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyServiceStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status dnscryptproxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop dnscryptproxy service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// dnscryptproxyWhitelistColumns defines table columns for the Whitelist resource.
var dnscryptproxyWhitelistColumns = []cli.Column{
	{Header: "NAME", Extract: func(row any) string {
		if v, ok := row.(sdk.Whitelist); ok {
			return fmt.Sprint(v.Name)
		}
		return ""
	}},
	{Header: "ENABLED", Extract: func(row any) string {
		if v, ok := row.(sdk.Whitelist); ok {
			return fmt.Sprint(v.Enabled)
		}
		return ""
	}},
	{Header: "DESCRIPTION", Extract: func(row any) string {
		if v, ok := row.(sdk.Whitelist); ok {
			return fmt.Sprint(v.Description)
		}
		return ""
	}},
}

func newDnscryptproxyWhitelistCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "whitelist",
		Short: "Manage dnscryptproxy whitelist resources",
	}
	cmd.AddCommand(newDnscryptproxyWhitelistCreateCmd())
	cmd.AddCommand(newDnscryptproxyWhitelistDeleteCmd())
	cmd.AddCommand(newDnscryptproxyWhitelistGetCmd())
	cmd.AddCommand(newDnscryptproxyWhitelistListCmd())
	cmd.AddCommand(newDnscryptproxyWhitelistSetCmd())
	cmd.AddCommand(newDnscryptproxyWhitelistUpdateCmd())
	cmd.AddCommand(newDnscryptproxyWhitelistToggleCmd())
	return cmd
}

func newDnscryptproxyWhitelistCreateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "create",
		Short: "Create dnscryptproxy whitelist",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Whitelist
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.WhitelistAddWhitelist(context.Background(), &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newDnscryptproxyWhitelistDeleteCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "delete <uuid>",
		Short: "Delete dnscryptproxy whitelist",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.WhitelistDelWhitelist(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyWhitelistGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get dnscryptproxy whitelist",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.WhitelistGetWhitelist(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

func newDnscryptproxyWhitelistListCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "list",
		Short: "List dnscryptproxy whitelist resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			result, err := s.WhitelistSearchWhitelist(context.Background(), map[string]any{"rowCount": -1, "current": 1})
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			rows := make([]any, len(result.Rows))
			for i, r := range result.Rows {
				rows[i] = r
			}
			return printer.PrintTable(rows, dnscryptproxyWhitelistColumns)
		},
	}
}

func newDnscryptproxyWhitelistSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set dnscryptproxy whitelist",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.WhitelistSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newDnscryptproxyWhitelistUpdateCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "update <uuid>",
		Short: "Update dnscryptproxy whitelist",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			dataStr, _ := cmd.Flags().GetString("data")
			var body sdk.Whitelist
			if err := json.Unmarshal([]byte(dataStr), &body); err != nil {
				return fmt.Errorf("parsing --data: %w", err)
			}
			s := sdk.NewClient(c)
			resp, err := s.WhitelistSetWhitelist(context.Background(), args[0], &body)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
	cmd.Flags().String("data", "{}", "JSON body (can use '-' to read from stdin)")
	return cmd
}

func newDnscryptproxyWhitelistToggleCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "toggle <uuid>",
		Short: "Toggle dnscryptproxy whitelist",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.WhitelistToggleWhitelist(context.Background(), args[0])
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintGenericResponse(resp)
		},
	}
}

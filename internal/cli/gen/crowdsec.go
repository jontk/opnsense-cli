// Code generated by opnsense-cli/generate; DO NOT EDIT.

package gen

import (
	"context"
	"fmt"

	"github.com/jontk/opnsense-cli/internal/cli"
	sdk "github.com/jontk/opnsense-cli/opnsense/crowdsec"
	"github.com/spf13/cobra"
)

func init() {
	registerCrowdsec()
}

func registerCrowdsec() {
	moduleCmd := &cobra.Command{
		Use:   "crowdsec",
		Short: "Manage crowdsec resources",
		RunE: func(cmd *cobra.Command, args []string) error {
			if len(args) == 0 {
				return cmd.Help()
			}
			msg := fmt.Sprintf("unknown command %q for %q", args[0], cmd.CommandPath())
			if sugg := cmd.SuggestionsFor(args[0]); len(sugg) > 0 {
				msg += "\n\nDid you mean this?"
				for _, s := range sugg {
					msg += "\n\t" + s
				}
			}
			return fmt.Errorf("%s\n\nRun '%s --help' for usage.", msg, cmd.CommandPath())
		},
	}
	moduleCmd.AddCommand(newCrowdsecAlertsCmd())
	moduleCmd.AddCommand(newCrowdsecAppsecconfigsCmd())
	moduleCmd.AddCommand(newCrowdsecAppsecrulesCmd())
	moduleCmd.AddCommand(newCrowdsecBouncersCmd())
	moduleCmd.AddCommand(newCrowdsecCollectionsCmd())
	moduleCmd.AddCommand(newCrowdsecDecisionsCmd())
	moduleCmd.AddCommand(newCrowdsecGeneralCmd())
	moduleCmd.AddCommand(newCrowdsecMachinesCmd())
	moduleCmd.AddCommand(newCrowdsecParsersCmd())
	moduleCmd.AddCommand(newCrowdsecPostoverflowsCmd())
	moduleCmd.AddCommand(newCrowdsecScenariosCmd())
	moduleCmd.AddCommand(newCrowdsecServiceCmd())
	moduleCmd.AddCommand(newCrowdsecVersionCmd())
	cli.Root.AddCommand(moduleCmd)
}

func newCrowdsecAlertsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "alerts",
		Short: "Manage crowdsec alerts resources",
	}
	cmd.AddCommand(newCrowdsecAlertsSearchCmd())
	return cmd
}

func newCrowdsecAlertsSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec alerts",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AlertsSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecAppsecconfigsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "appsecconfigs",
		Short: "Manage crowdsec appsecconfigs resources",
	}
	cmd.AddCommand(newCrowdsecAppsecconfigsSearchCmd())
	return cmd
}

func newCrowdsecAppsecconfigsSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec appsecconfigs",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AppsecconfigsSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecAppsecrulesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "appsecrules",
		Short: "Manage crowdsec appsecrules resources",
	}
	cmd.AddCommand(newCrowdsecAppsecrulesSearchCmd())
	return cmd
}

func newCrowdsecAppsecrulesSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec appsecrules",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.AppsecrulesSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecBouncersCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "bouncers",
		Short: "Manage crowdsec bouncers resources",
	}
	cmd.AddCommand(newCrowdsecBouncersSearchCmd())
	return cmd
}

func newCrowdsecBouncersSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec bouncers",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.BouncersSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecCollectionsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "collections",
		Short: "Manage crowdsec collections resources",
	}
	cmd.AddCommand(newCrowdsecCollectionsSearchCmd())
	return cmd
}

func newCrowdsecCollectionsSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec collections",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.CollectionsSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecDecisionsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "decisions",
		Short: "Manage crowdsec decisions resources",
	}
	cmd.AddCommand(newCrowdsecDecisionsDelCmd())
	cmd.AddCommand(newCrowdsecDecisionsSearchCmd())
	return cmd
}

func newCrowdsecDecisionsDelCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "del <decision_id>",
		Short: "Del crowdsec decisions",
		Args:  cobra.ExactArgs(1),
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DecisionsDel(context.Background(), args[0], nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecDecisionsSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec decisions",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.DecisionsSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecGeneralCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "general",
		Short: "Manage crowdsec general resources",
	}
	cmd.AddCommand(newCrowdsecGeneralGetCmd())
	cmd.AddCommand(newCrowdsecGeneralSetCmd())
	return cmd
}

func newCrowdsecGeneralGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get crowdsec general",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.GeneralGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecGeneralSetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "set",
		Short: "Set crowdsec general",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.GeneralSet(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecMachinesCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "machines",
		Short: "Manage crowdsec machines resources",
	}
	cmd.AddCommand(newCrowdsecMachinesSearchCmd())
	return cmd
}

func newCrowdsecMachinesSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec machines",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.MachinesSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecParsersCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "parsers",
		Short: "Manage crowdsec parsers resources",
	}
	cmd.AddCommand(newCrowdsecParsersSearchCmd())
	return cmd
}

func newCrowdsecParsersSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec parsers",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ParsersSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecPostoverflowsCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "postoverflows",
		Short: "Manage crowdsec postoverflows resources",
	}
	cmd.AddCommand(newCrowdsecPostoverflowsSearchCmd())
	return cmd
}

func newCrowdsecPostoverflowsSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec postoverflows",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.PostoverflowsSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecScenariosCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "scenarios",
		Short: "Manage crowdsec scenarios resources",
	}
	cmd.AddCommand(newCrowdsecScenariosSearchCmd())
	return cmd
}

func newCrowdsecScenariosSearchCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "search",
		Short: "Search crowdsec scenarios",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ScenariosSearch(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecServiceCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "service",
		Short: "Manage crowdsec service resources",
	}
	cmd.AddCommand(newCrowdsecServiceReconfigureCmd())
	cmd.AddCommand(newCrowdsecServiceRestartCmd())
	cmd.AddCommand(newCrowdsecServiceStartCmd())
	cmd.AddCommand(newCrowdsecServiceStatusCmd())
	cmd.AddCommand(newCrowdsecServiceStopCmd())
	return cmd
}

func newCrowdsecServiceReconfigureCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "reconfigure",
		Short: "Reconfigure crowdsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceReconfigure(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecServiceRestartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "restart",
		Short: "Restart crowdsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceRestart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecServiceStartCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "start",
		Short: "Start crowdsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStart(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecServiceStatusCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "status",
		Short: "Status crowdsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStatus(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecServiceStopCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "stop",
		Short: "Stop crowdsec service",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.ServiceStop(context.Background(), nil)
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

func newCrowdsecVersionCmd() *cobra.Command {
	cmd := &cobra.Command{
		Use:   "version",
		Short: "Manage crowdsec version resources",
	}
	cmd.AddCommand(newCrowdsecVersionGetCmd())
	return cmd
}

func newCrowdsecVersionGetCmd() *cobra.Command {
	return &cobra.Command{
		Use:   "get",
		Short: "Get crowdsec version",
		RunE: func(cmd *cobra.Command, args []string) error {
			c, cfg, err := cli.NewClientFromCmd(cmd)
			if err != nil {
				return err
			}
			s := sdk.NewClient(c)
			resp, err := s.VersionGet(context.Background())
			if err != nil {
				return err
			}
			printer := cli.NewPrinter(cfg)
			return printer.PrintJSON(resp)
		},
	}
}

// Code generated by opnsense-cli/generate; DO NOT EDIT.

// Package stunnel provides a client for the OPNsense stunnel API.
package stunnel

import (
	"context"
	"fmt"

	"github.com/jontk/opnsense-cli/opnsense"
)

// Client wraps the base OPNsense client for stunnel API calls.
type Client struct {
	client *opnsense.Client
}

// NewClient creates a new stunnel API client.
func NewClient(c *opnsense.Client) *Client {
	return &Client{client: c}
}

// ServiceReconfigure calls POST /api/stunnel/service/reconfigure
func (c *Client) ServiceReconfigure(ctx context.Context, body any) (any, error) {
	path := "/api/stunnel/service/reconfigure"
	var resp any
	err := c.client.Do(ctx, "POST", path, body, &resp)
	return resp, err
}

// ServiceRestart calls POST /api/stunnel/service/restart
func (c *Client) ServiceRestart(ctx context.Context, body any) (any, error) {
	path := "/api/stunnel/service/restart"
	var resp any
	err := c.client.Do(ctx, "POST", path, body, &resp)
	return resp, err
}

// ServiceStart calls POST /api/stunnel/service/start
func (c *Client) ServiceStart(ctx context.Context, body any) (any, error) {
	path := "/api/stunnel/service/start"
	var resp any
	err := c.client.Do(ctx, "POST", path, body, &resp)
	return resp, err
}

// ServiceStatus calls GET /api/stunnel/service/status
func (c *Client) ServiceStatus(ctx context.Context) (any, error) {
	path := "/api/stunnel/service/status"
	var resp any
	err := c.client.Do(ctx, "GET", path, nil, &resp)
	return resp, err
}

// ServiceStop calls POST /api/stunnel/service/stop
func (c *Client) ServiceStop(ctx context.Context, body any) (any, error) {
	path := "/api/stunnel/service/stop"
	var resp any
	err := c.client.Do(ctx, "POST", path, body, &resp)
	return resp, err
}

// ServicesAddItem calls POST /api/stunnel/services/addItem
func (c *Client) ServicesAddItem(ctx context.Context, body *Service) (*opnsense.GenericResponse, error) {
	path := "/api/stunnel/services/addItem"
	var resp opnsense.GenericResponse
	err := c.client.Do(ctx, "POST", path, map[string]any{"service": body}, &resp)
	return &resp, err
}

// ServicesDelItem calls POST /api/stunnel/services/delItem
// Parameters:
//   - uuid
func (c *Client) ServicesDelItem(ctx context.Context, uuid string) (*opnsense.GenericResponse, error) {
	path := fmt.Sprintf("/api/stunnel/services/delItem/%s", uuid)
	var resp opnsense.GenericResponse
	err := c.client.Do(ctx, "POST", path, nil, &resp)
	return &resp, err
}

// ServicesGet calls GET /api/stunnel/services/get
func (c *Client) ServicesGet(ctx context.Context) (any, error) {
	path := "/api/stunnel/services/get"
	var resp any
	err := c.client.Do(ctx, "GET", path, nil, &resp)
	return resp, err
}

// ServicesGetItem calls GET /api/stunnel/services/getItem
// Parameters:
//   - uuid (optional, default: null)
func (c *Client) ServicesGetItem(ctx context.Context, opts ...string) (*Service, error) {
	path := "/api/stunnel/services/getItem"
	for _, o := range opts {
		path += "/" + o
	}
	var resp serviceGetItemResponse
	err := c.client.Do(ctx, "GET", path, nil, &resp)
	return &resp.Service, err
}

// ServicesSearchItem calls GET,POST /api/stunnel/services/searchItem
func (c *Client) ServicesSearchItem(ctx context.Context, body any) (*opnsense.SearchResult[Service], error) {
	path := "/api/stunnel/services/searchItem"
	var resp opnsense.SearchResult[Service]
	err := c.client.Do(ctx, "POST", path, body, &resp)
	return &resp, err
}

// ServicesSet calls POST /api/stunnel/services/set
func (c *Client) ServicesSet(ctx context.Context, body any) (any, error) {
	path := "/api/stunnel/services/set"
	var resp any
	err := c.client.Do(ctx, "POST", path, body, &resp)
	return resp, err
}

// ServicesSetItem calls POST /api/stunnel/services/setItem
// Parameters:
//   - uuid
func (c *Client) ServicesSetItem(ctx context.Context, uuid string, body *Service) (*opnsense.GenericResponse, error) {
	path := fmt.Sprintf("/api/stunnel/services/setItem/%s", uuid)
	var resp opnsense.GenericResponse
	err := c.client.Do(ctx, "POST", path, map[string]any{"service": body}, &resp)
	return &resp, err
}

// ServicesToggleItem calls POST /api/stunnel/services/toggleItem
// Parameters:
//   - uuid
//   - enabled (optional, default: null)
func (c *Client) ServicesToggleItem(ctx context.Context, uuid string, opts ...string) (*opnsense.GenericResponse, error) {
	path := fmt.Sprintf("/api/stunnel/services/toggleItem/%s", uuid)
	for _, o := range opts {
		path += "/" + o
	}
	var resp opnsense.GenericResponse
	err := c.client.Do(ctx, "POST", path, nil, &resp)
	return &resp, err
}

// Code generated by opnsense-cli/generate; DO NOT EDIT.

// Package {{ package_name }} provides a client for the OPNsense {{ module_name }} API.
package {{ package_name }}

import (
	"context"
{% if needs_fmt %}
	"fmt"
{% endif %}

	"github.com/jontk/opnsense-cli/opnsense"
)

// Client wraps the base OPNsense client for {{ module_name }} API calls.
type Client struct {
	client *opnsense.Client
}

// NewClient creates a new {{ module_name }} API client.
func NewClient(c *opnsense.Client) *Client {
	return &Client{client: c}
}
{% for ep in endpoints %}

// {{ ep.go_method_name }} calls {{ ep.methods|join(',') }} {{ ep.url_path }}
{% if ep.parameters %}
// Parameters:
{% for p in ep.parameters %}
//   - {{ p.name }}{% if not p.required %} (optional{% if p.default is not none %}, default: {{ p.default }}{% endif %}){% endif %}

{% endfor %}
{% endif %}
{% if ep.crud_verb in ("add", "set") and ep.item_type %}
{# ── Typed add/set: takes *ItemType, returns *GenericResponse ── #}
func (c *Client) {{ ep.go_method_name }}(ctx context.Context{% for p in ep.required_params %}, {{ p.name }} string{% endfor %}, body *{{ ep.item_type }}{% if ep.optional_params %}, opts ...string{% endif %}) (*opnsense.GenericResponse, error) {
{% if ep.path_fmt %}
	path := fmt.Sprintf("{{ ep.path_fmt }}"{% for p in ep.required_params %}, {{ p.name }}{% endfor %})
{% else %}
	path := "{{ ep.url_path }}"
{% endif %}
{% if ep.optional_params %}
	for _, o := range opts {
		path += "/" + o
	}
{% endif %}
	var resp opnsense.GenericResponse
	err := c.client.Do(ctx, "POST", path, map[string]any{"{{ ep.item_json_key }}": body}, &resp)
	return &resp, err
}
{% elif ep.crud_verb == "get" and ep.item_type %}
{# ── Typed get: returns *ItemType via wrapper ── #}
func (c *Client) {{ ep.go_method_name }}(ctx context.Context{% for p in ep.required_params %}, {{ p.name }} string{% endfor %}{% if ep.optional_params %}, opts ...string{% endif %}) (*{{ ep.item_type }}, error) {
{% if ep.path_fmt %}
	path := fmt.Sprintf("{{ ep.path_fmt }}"{% for p in ep.required_params %}, {{ p.name }}{% endfor %})
{% else %}
	path := "{{ ep.url_path }}"
{% endif %}
{% if ep.optional_params %}
	for _, o := range opts {
		path += "/" + o
	}
{% endif %}
	var resp {{ ep.item_json_key }}GetItemResponse
	err := c.client.Do(ctx, "GET", path, nil, &resp)
	return &resp.{{ ep.item_type }}, err
}
{% elif ep.crud_verb in ("del", "toggle") and ep.item_type %}
{# ── Typed del/toggle: returns *GenericResponse, optional params as variadic ── #}
func (c *Client) {{ ep.go_method_name }}(ctx context.Context{% for p in ep.required_params %}, {{ p.name }} string{% endfor %}{% if ep.optional_params %}, opts ...string{% endif %}) (*opnsense.GenericResponse, error) {
{% if ep.path_fmt %}
	path := fmt.Sprintf("{{ ep.path_fmt }}"{% for p in ep.required_params %}, {{ p.name }}{% endfor %})
{% else %}
	path := "{{ ep.url_path }}"
{% endif %}
{% if ep.optional_params %}
	for _, o := range opts {
		path += "/" + o
	}
{% endif %}
	var resp opnsense.GenericResponse
	err := c.client.Do(ctx, "POST", path, nil, &resp)
	return &resp, err
}
{% elif ep.crud_verb == "search" and ep.item_type %}
{# ── Typed search: returns *opnsense.SearchResult[ItemType] ── #}
func (c *Client) {{ ep.go_method_name }}(ctx context.Context{% for p in ep.required_params %}, {{ p.name }} string{% endfor %}{% if ep.has_body %}, body any{% endif %}{% if ep.optional_params %}, opts ...string{% endif %}) (*opnsense.SearchResult[{{ ep.item_type }}], error) {
{% if ep.path_fmt %}
	path := fmt.Sprintf("{{ ep.path_fmt }}"{% for p in ep.required_params %}, {{ p.name }}{% endfor %})
{% else %}
	path := "{{ ep.url_path }}"
{% endif %}
{% if ep.optional_params %}
	for _, o := range opts {
		path += "/" + o
	}
{% endif %}
	var resp opnsense.SearchResult[{{ ep.item_type }}]
{% if ep.primary_method == "POST" %}
	err := c.client.Do(ctx, "POST", path, {% if ep.has_body %}body{% else %}nil{% endif %}, &resp)
{% else %}
	err := c.client.Do(ctx, "GET", path, nil, &resp)
{% endif %}
	return &resp, err
}
{% else %}
{# ── Untyped: keeps current signature with optional params ── #}
func (c *Client) {{ ep.go_method_name }}(ctx context.Context{% for p in ep.required_params %}, {{ p.name }} string{% endfor %}{% if ep.has_body %}, body any{% endif %}{% if ep.optional_params %}, opts ...string{% endif %}) (any, error) {
{% if ep.path_fmt %}
	path := fmt.Sprintf("{{ ep.path_fmt }}"{% for p in ep.required_params %}, {{ p.name }}{% endfor %})
{% else %}
	path := "{{ ep.url_path }}"
{% endif %}
{% if ep.optional_params %}
	for _, o := range opts {
		path += "/" + o
	}
{% endif %}
	var resp any
{% if ep.primary_method == "POST" %}
	err := c.client.Do(ctx, "POST", path, {% if ep.has_body %}body{% else %}nil{% endif %}, &resp)
{% else %}
	err := c.client.Do(ctx, "GET", path, nil, &resp)
{% endif %}
	return resp, err
}
{% endif %}
{% endfor %}
